---
title: "TOMST Work"
author: "Gabby John"
date: "`r Sys.Date()`"
output: html_document
---


```{r setup, include=FALSE}
# install.packages("devtools")
library(devtools)
# devtools::install_github("treenet/treenetproc")
library(treenetproc, `force = TRUE`)
library(ggplot2)
library(lubridate)
library(tidyr)
library(scales)
library(dplyr)

left <- function(string, char){substr(string, 1,char)} 
right <- function (string, char){substr(string,nchar(string)-(char-1),nchar(string))}

setwd("~/research2/TreeNetProc/TOMST")
```



#More notes
look into class in INT BIO maybe on data organizing and github bc it's important to have all my code backed up in a repository on github if not look into library workshop github - rstudio integration
uplo7297 if we just started in april or maybe just may 1 bc of pre-may weirdness but if we have everything separated by tree i can have a spearate line of thinking and code individualized for each tree 

for next week dec 2 look at ford paper and supplemental so that we can look at model together for initiation days to look at what model precicts should be look at other met stations for uplo for better analysis and modeling 



histogram of ZO so we can see when in the year the stressors happen re:early vs late season stress to growth 

## Step 1: read in dendrometer data and get formats right
While we're here, let's also add a column for years so we can plot in ggplot instead of base R

R will not open your CSV file if its title starts with a number and will instead give an error message. You can change the title so it starts with a letter character instead. 
Make sure that the NA strings reader matches the NA codes in the original CSV file.

#Reading in PRIMET data for relevant years

```{r}
#This will take a while
load("~/research2/climate_analyses/Primet Processing/Primet2014_2024.RData")
Primet2014_2024$ts<-as.POSIXct(Primet2014_2024$Date,format="%Y-%m-%d %H:%M:%S",tz="GMT")
Primet2014_2024$yr<-format(Primet2014_2024$ts,"%Y")
PrimetTOMST<-Primet2014_2024|>filter(yr%in%c("2022","2023","2024"))
PrimetTOMST<-PrimetTOMST|>select(c(PRECIP_TOT_100_0_01,PRECIP_ACC_100_0_01,Flag_PRECIP_ACC_100_0_01,Flag_PRECIP_TOT_100_0_01,Date,ts,SOILTEMP_MEAN_0_10_01,Flag_SOILTEMP_MEAN_0_10_01))

PrimetTOMST$PRECIP_TOT_100_0_01[PrimetTOMST$Flag_PRECIP_TOT_100_0_01=="Q"] <- NA
PrimetTOMST$PRECIP_ACC_100_0_01[PrimetTOMST$Flag_PRECIP_ACC_100_0_01=="Q"] <- NA
PrimetTOMST$SOILTEMP_MEAN_0_10_01[PrimetTOMST$Flag_SOILTEMP_MEAN_0_10_01=="I"] <- NA

PrimetTOMST$AccPrecip<-
  PrimetTOMST$PRECIP_ACC_100_0_01
PrimetTOMST$SoilTemp<-PrimetTOMST$SOILTEMP_MEAN_0_10_01
```
#Reading in other met data to match each dendro location
Precip INST = Shelter rain guage?
2 Acc. Precip: PRECIP_ACC_625_0_02	mm	floating-point	Cumulative sum of total precipitation
and            PRECIP_ACC_455_0_01	mm	floating-point	Cumulative sum of total precipitation

```{r}
#Central Meteorological Station (1020m elevation)
CEN233_2023WY<-read.csv("~/research2/TreeNetProc/TOMST/CENMET/cenmet_233_a_5min_2023.csv")
CEN233_2024WY<-read.csv("~/research2/TreeNetProc/TOMST/CENMET/cenmet_233_a_5min_2024.csv")
CEN233<-bind_rows(CEN233_2023WY,CEN233_2024WY)

CEN234_2023WY<-read.csv("~/research2/TreeNetProc/TOMST/CENMET/cenmet_234_a_5min_2023.csv")
CEN234_2024WY<-read.csv("~/research2/TreeNetProc/TOMST/CENMET/cenmet_234_a_5min_2024.csv")
CEN234<-bind_rows(CEN234_2023WY,CEN234_2024WY)

CENMET<-full_join(CEN233,CEN234,by="Date")
CENMET$ts<-as.POSIXct(CENMET$Date,format="%Y-%m-%d %H:%M:%S",tz="GMT")
CENMETaccprecip<-CENMET|>select(c(ts,PRECIP_ACC_455_0_01,PRECIP_ACC_625_0_02,Flag_PRECIP_ACC_455_0_01,Flag_PRECIP_ACC_625_0_02))
#455 has fewer flags. Flags are F,M,R. See differences below

ggplot(CENMET,)
ggplot(CENMET, aes(x = ts)) +geom_point(aes(y = PRECIP_ACC_455_0_01), color = "red") +
  geom_point(aes(y = PRECIP_ACC_625_0_02), color = "blue")


#Taking out bad flags
CENMETaccprecip$PRECIP_ACC_455_0_01[CENMETaccprecip$Flag_PRECIP_ACC_455_0_01=="F"] <- NA
CENMETaccprecip$PRECIP_ACC_455_0_01[CENMETaccprecip$Flag_PRECIP_ACC_455_0_01=="M"] <- NA
CENMETaccprecip$PRECIP_ACC_455_0_01[CENMETaccprecip$Flag_PRECIP_ACC_455_0_01=="R"] <- NA

CENMETaccprecip<-CENMETaccprecip|>select(c(ts,PRECIP_ACC_455_0_01))



#Reference Stand 20
#Only has RS20_95 (air temperature, soil temperature)
RS20_95_2023WY<-read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_95_a_5min_2023.csv")
RS20_95_2024WY<-read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_95_a_5min_2024.csv")
RS20_95<-bind_rows(RS20_95_2023WY,RS20_95_2024WY)

#UPLO starts 2025WY

#Vanilla Met Station
#Given time frame only has VANMET242 (soil temperature, wind speed/direction, soil moisture) and
#             VANMET241 (air temperature, relative humidity, dew point, radiation, battery supply)
VAN242_2023WY<-read.csv("~/research2/TreeNetProc/TOMST/VAN/vanmet_242_a_5min_2023.csv")
VAN242_2024WY<-read.csv("~/research2/TreeNetProc/TOMST/VAN/vanmet_242_a_5min_2024.csv")
VAN242<-bind_rows(VAN242_2023WY,VAN242_2024WY)
```





```{r}
#Loading in the 32 TOMST datasets with timestamps and micrometers 

CEN5180ts<- read.csv("~/research2/TreeNetProc/TOMST/CENMET/CEN_5180_ts_DMY.csv",stringsAsFactors = TRUE)
CEN5180ts$value<-as.numeric(CEN5180ts$value)
CEN5180ts$ts<-parse_date_time(CEN5180ts$ts,orders=c("dmy","dmy HMS"))
CEN5180ts$yr<-format(CEN5180ts$ts, "%Y")
CEN5180ts$yr<-as.factor(CEN5180ts$yr)


CEN8642ts<- read.csv("~/research2/TreeNetProc/TOMST/CENMET/CEN_8642_ts_DMY.csv",stringsAsFactors = TRUE)
CEN8642ts$value<-as.numeric(CEN8642ts$value)
CEN8642ts$ts<-parse_date_time(CEN8642ts$ts,orders=c("dmy","dmy HMS"))
CEN8642ts$ts <- as.POSIXct(CEN8642ts$ts,format="%d.%m.%Y %H:%M",tz="GMT") 
CEN8642ts$yr<-format(CEN8642ts$ts, "%Y")
CEN8642ts$yr<-as.factor(CEN8642ts$yr)


DT311ts <- read.csv("~/research2/TreeNetProc/TOMST/DT/DT311ts.csv", stringsAsFactors=TRUE)
DT311ts$ts<-DT311ts$datetime
DT311ts$value<-as.numeric(DT311ts$value)
DT311ts$ts<-as.POSIXct(DT311ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT311ts$ts<-parse_date_time(DT311ts$ts,orders=c("ymd","ymd HMS"))
DT311ts$yr<-format(DT311ts$ts, "%Y")
DT311ts$yr<-as.factor(DT311ts$yr)


DT646ts <- read.csv("~/research2/TreeNetProc/TOMST/DT/DT646ts.csv", stringsAsFactors=TRUE)
DT646ts$ts<-DT646ts$datetime
DT646ts$value<-as.numeric(DT646ts$value)
DT646ts$ts<-as.POSIXct(DT646ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT646ts$ts<-parse_date_time(DT646ts$ts,orders=c("ymd","ymd HMS"))
DT646ts$yr<-format(DT646ts$ts, "%Y")
DT646ts$yr<-as.factor(DT646ts$yr)



DT655ts <- read.csv("~/research2/TreeNetProc/TOMST/DT/DT655ts.csv", stringsAsFactors=TRUE)
DT655ts$ts<-DT655ts$datetime
DT655ts$value<-as.numeric(DT655ts$value)
DT655ts$ts<-as.POSIXct(DT655ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT655ts$ts<-parse_date_time(DT655ts$ts,orders=c("ymd","ymd HMS"))
DT655ts$yr<-format(DT655ts$ts, "%Y")
DT655ts$yr<-as.factor(DT655ts$yr)


HQRIP112ts<- read.csv("~/research2/TreeNetProc/TOMST/HQRIP/HQRIP_112_ts_YMD.csv", stringsAsFactors = TRUE)
HQRIP112ts$value<-as.numeric(HQRIP112ts$value)
HQRIP112ts$ts<-as.POSIXct(HQRIP112ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP112ts$ts<-parse_date_time(HQRIP112ts$ts,orders=c("ymd","ymd HMS"))
HQRIP112ts$yr<-format(HQRIP112ts$ts, "%Y")
HQRIP112ts$yr<-as.factor(HQRIP112ts$yr)


HQRIP113ts<- read.csv("~/research2/TreeNetProc/TOMST/HQRIP/HQRIP_113_ts_YMD.csv",stringsAsFactors = TRUE)
HQRIP113ts$value<-as.numeric(HQRIP113ts$value)
HQRIP113ts$ts<-as.POSIXct(HQRIP113ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP113ts$ts<-parse_date_time(HQRIP113ts$ts,orders=c("ymd","ymd HMS"))
HQRIP113ts$yr<-format(HQRIP113ts$ts, "%Y")
HQRIP113ts$yr<-as.factor(HQRIP113ts$yr)



HQRIP116ts<- read.csv("~/research2/TreeNetProc/TOMST/HQRIP/HQRIP_116_ts_YMD.csv",stringsAsFactors = TRUE)
HQRIP116ts$value<-as.numeric(HQRIP116ts$value)
HQRIP116ts$ts<-as.POSIXct(HQRIP116ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP116ts$ts<-parse_date_time(HQRIP116ts$ts,orders=c("ymd","ymd HMS"))
HQRIP116ts$yr<-format(HQRIP116ts$ts, "%Y")
HQRIP116ts$yr<-as.factor(HQRIP116ts$yr)



HQSWP118ts<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_118_ts_YMD.csv", stringsAsFactors = TRUE)
HQSWP118ts$value<-as.numeric(HQSWP118ts$value)
HQSWP118ts$ts<-as.POSIXct(HQSWP118ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP118ts$ts<-parse_date_time(HQSWP118ts$ts,orders=c("ymd","ymd HMS"))
HQSWP118ts$yr<-format(HQSWP118ts$ts, "%Y")
HQSWP118ts$yr<-as.factor(HQSWP118ts$yr)



HQSWP119ts<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_119_ts_YMD.csv", stringsAsFactors = TRUE)
HQSWP119ts$value<-as.numeric(HQSWP119ts$value)
HQSWP119ts$ts<-as.POSIXct(HQSWP119ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP119ts$ts<-parse_date_time(HQSWP119ts$ts,orders=c("ymd","ymd HMS"))
HQSWP119ts$yr<-format(HQSWP119ts$ts, "%Y")
HQSWP119ts$yr<-as.factor(HQSWP119ts$yr)



HQSWP121ts<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_121_ts_formatted_badtemp.csv",stringsAsFactors = TRUE)
HQSWP121ts$value<-as.numeric(HQSWP121ts$value)
HQSWP121ts$ts<-as.POSIXct(HQSWP121ts$ts,format="%Y-%m-%d %H:%M",tz="GMT")
HQSWP121ts$ts<-parse_date_time(HQSWP121ts$ts,orders=c("ymd","ymd HMS"))
HQSWP121ts$yr<-format(HQSWP121ts$ts, "%Y")
HQSWP121ts$yr<-as.factor(HQSWP121ts$yr)



HQSWP122ts<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_122_ts_YMD.csv",stringsAsFactors = TRUE)
HQSWP122ts$value<-as.numeric(HQSWP122ts$value)
HQSWP122ts$ts<-as.POSIXct(HQSWP122ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP122ts$ts<-parse_date_time(HQSWP122ts$ts,orders=c("ymd","ymd HMS"))
HQSWP122ts$yr<-format(HQSWP122ts$ts, "%Y")
HQSWP122ts$yr<-as.factor(HQSWP122ts$yr)



HQSWP2577ts<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_2577_ts_YMD.csv", stringsAsFactors = TRUE)
HQSWP2577ts$value<-as.numeric(HQSWP2577ts$value)
HQSWP2577ts$ts<-as.POSIXct(HQSWP2577ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP2577ts$ts<-parse_date_time(HQSWP2577ts$ts,orders=c("ymd","ymd HMS"))
HQSWP2577ts$yr<-format(HQSWP2577ts$ts, "%Y")
HQSWP2577ts$yr<-as.factor(HQSWP2577ts$yr)


#The PCs get an error when trying to convert to POSIXct separately; not sure why.

PC07_5231ts<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC07_5231_ts_DMY.csv", stringsAsFactors = TRUE)
PC07_5231ts$value<-as.numeric(PC07_5231ts$value)
#PC07_5231ts$ts<-as.POSIXct(PC07_5231ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5231ts$ts<-parse_date_time(PC07_5231ts$ts,orders=c("dmy","dmy HMS"))
PC07_5231ts$yr<-format(PC07_5231ts$ts, "%Y")
PC07_5231ts$yr<-as.factor(PC07_5231ts$yr)


PC07_5445ts<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC07_5445_ts_DMY.csv",stringsAsFactors = TRUE)
PC07_5445ts$value<-as.numeric(PC07_5445ts$value)
#PC07_5445ts$ts<-as.POSIXct(PC07_5445ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5445ts$ts<-parse_date_time(PC07_5445ts$ts,orders=c("dmy","dmy HMS"))
PC07_5445ts$yr<-format(PC07_5445ts$ts, "%Y")
PC07_5445ts$yr<-as.factor(PC07_5445ts$yr)


PC09_3936ts<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC09_3936_ts_DMY.csv",stringsAsFactors = TRUE)
PC09_3936ts$value<-as.numeric(PC09_3936ts$value)
#PC09_3936ts$ts<-as.POSIXct(PC09_3936ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_3936ts$ts<-parse_date_time(PC09_3936ts$ts,orders=c("dmy","dmy HMS"))
PC09_3936ts$yr<-format(PC09_3936ts$ts, "%Y")
PC09_3936ts$yr<-as.factor(PC09_3936ts$yr)


PC09_4502ts<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC09_4502_ts_DMY.csv",stringsAsFactors = TRUE)
PC09_4502ts$value<-as.numeric(PC09_4502ts$value)
#PC09_4502ts$ts<-as.POSIXct(PC09_4502ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_4502ts$ts<-parse_date_time(PC09_4502ts$ts,orders=c("dmy","dmy HMS"))
PC09_4502ts$yr<-format(PC09_4502ts$ts, "%Y")
PC09_4502ts$yr<-as.factor(PC09_4502ts$yr)

RS20TSHE_624ts<-read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_TSHE_624_ts_YMD.csv", stringsAsFactors = TRUE)
RS20TSHE_624ts$value<-as.numeric(RS20TSHE_624ts$value)
RS20TSHE_624ts$ts<-as.POSIXct(RS20TSHE_624ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_624ts$ts<-parse_date_time(RS20TSHE_624ts$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_624ts$yr<-format(RS20TSHE_624ts$ts, "%Y")
RS20TSHE_624ts$yr<-as.factor(RS20TSHE_624ts$yr)


RS20TSHE_625ts<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_TSHE_625_ts_YMD.csv",
stringsAsFactors = TRUE)
RS20TSHE_625ts$value<-as.numeric(RS20TSHE_625ts$value)
RS20TSHE_625ts$ts<-as.POSIXct(RS20TSHE_625ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_625ts$ts<-parse_date_time(RS20TSHE_625ts$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_625ts$yr<-format(RS20TSHE_625ts$ts, "%Y")
RS20TSHE_625ts$yr<-as.factor(RS20TSHE_625ts$yr)


RS20TSHE_5523ts<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_TSHE_5523_ts_YMD.csv",
                     stringsAsFactors = TRUE)
RS20TSHE_5523ts$value<-as.numeric(RS20TSHE_5523ts$value)
RS20TSHE_5523ts$ts<-as.POSIXct(RS20TSHE_5523ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_5523ts$ts<-parse_date_time(RS20TSHE_5523ts$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_5523ts$yr<-format(RS20TSHE_5523ts$ts, "%Y")
RS20TSHE_5523ts$yr<-as.factor(RS20TSHE_5523ts$yr)


RS20LWS_base_ts<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20LWS_base_ts_YMD.csv",
                     stringsAsFactors = TRUE)
RS20LWS_base_ts$value<-as.numeric(RS20LWS_base_ts$value)
RS20LWS_base_ts$ts<-as.POSIXct(RS20LWS_base_ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_base_ts$ts<-parse_date_time(RS20LWS_base_ts$ts,orders=c("ymd","ymd HMS"))
RS20LWS_base_ts$yr<-format(RS20LWS_base_ts$ts, "%Y")
RS20LWS_base_ts$yr<-as.factor(RS20LWS_base_ts$yr)

RS20LWS_branch_ts<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20LWS_branch_ts_YMD.csv",
                     stringsAsFactors = TRUE)
RS20LWS_branch_ts$value<-as.numeric(RS20LWS_branch_ts$value)
RS20LWS_branch_ts$ts<-as.POSIXct(RS20LWS_branch_ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_branch_ts$ts<-parse_date_time(RS20LWS_branch_ts$ts,orders=c("ymd","ymd HMS"))
RS20LWS_branch_ts$yr<-format(RS20LWS_branch_ts$ts, "%Y")
RS20LWS_branch_ts$yr<-as.factor(RS20LWS_branch_ts$yr)

RS20LWS_midcanopy_ts<-read.csv("~/research2/TreeNetProc/TOMST/RS/RS20LWS_midcanopy_ts_YMD.csv",stringsAsFactors = TRUE)
RS20LWS_midcanopy_ts$value<-as.numeric(RS20LWS_midcanopy_ts$value)
RS20LWS_midcanopy_ts$ts<-as.POSIXct(RS20LWS_midcanopy_ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_midcanopy_ts$ts<-parse_date_time(RS20LWS_midcanopy_ts$ts,orders=c("ymd","ymd HMS"))
RS20LWS_midcanopy_ts$yr<-format(RS20LWS_midcanopy_ts$ts, "%Y")
RS20LWS_midcanopy_ts$yr<-as.factor(RS20LWS_midcanopy_ts$yr)


UPLO_660ts<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_660_ts_YMD.csv",stringsAsFactors = TRUE)
UPLO_660ts$value<-as.numeric(UPLO_660ts$value)
UPLO_660ts$ts<-as.POSIXct(UPLO_660ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_660ts$ts<-parse_date_time(UPLO_660ts$ts,orders=c("ymd","ymd HMS"))
UPLO_660ts$yr<-format(UPLO_660ts$ts, "%Y")
UPLO_660ts$yr<-as.factor(UPLO_660ts$yr)


UPLO_662ts<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_662_ts_YMD.csv",stringsAsFactors = TRUE)
UPLO_662ts$value<-as.numeric(UPLO_662ts$value)
UPLO_662ts$ts<-as.POSIXct(UPLO_662ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_662ts$ts<-parse_date_time(UPLO_662ts$ts,orders=c("ymd","ymd HMS"))
UPLO_662ts$yr<-format(UPLO_662ts$ts, "%Y")
UPLO_662ts$yr<-as.factor(UPLO_662ts$yr)


UPLO_664ts<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_664_ts_YMD.csv", stringsAsFactors = TRUE)
UPLO_664ts$value<-as.numeric(UPLO_664ts$value)
UPLO_664ts$ts<-as.POSIXct(UPLO_664ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_664ts$ts<-parse_date_time(UPLO_664ts$ts,orders=c("ymd","ymd HMS"))
UPLO_664ts$yr<-format(UPLO_664ts$ts, "%Y")
UPLO_664ts$yr<-as.factor(UPLO_664ts$yr)


UPLO_665ts<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_665_ts_YMD.csv",stringsAsFactors = TRUE)
UPLO_665ts$value<-as.numeric(UPLO_665ts$value)
UPLO_665ts$ts<-as.POSIXct(UPLO_665ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_665ts$ts<-parse_date_time(UPLO_665ts$ts,orders=c("ymd","ymd HMS"))
UPLO_665ts$yr<-format(UPLO_665ts$ts, "%Y")
UPLO_665ts$yr<-as.factor(UPLO_665ts$yr)


UPLO_abbr7297ts<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_7297_abbr_ts_YMD.csv",
                     stringsAsFactors = TRUE)
UPLO_abbr7297ts$value<-as.numeric(UPLO_abbr7297ts$value)
UPLO_abbr7297ts$ts<-as.POSIXct(UPLO_abbr7297ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_abbr7297ts$ts<-parse_date_time(UPLO_abbr7297ts$ts,orders=c("ymd","ymd HMS"))
UPLO_abbr7297ts$yr<-format(UPLO_abbr7297ts$ts, "%Y")
UPLO_abbr7297ts$yr<-as.factor(UPLO_abbr7297ts$yr)


UPLO_7297ts<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_7297_ts_YMD.csv",
                     stringsAsFactors = TRUE)
UPLO_7297ts$value<-as.numeric(UPLO_7297ts$value)
UPLO_7297ts$ts<-as.POSIXct(UPLO_7297ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_7297ts$ts<-parse_date_time(UPLO_7297ts$ts,orders=c("ymd","ymd HMS"))
UPLO_7297ts$yr<-format(UPLO_7297ts$ts, "%Y")
UPLO_7297ts$yr<-as.factor(UPLO_7297ts$yr)


VAN_abbr621ts<- read.csv("~/research2/TreeNetProc/TOMST/VAN/VAN_621_abbr_ts_DMY.csv",
                     stringsAsFactors = TRUE)
VAN_abbr621ts$value<-as.numeric(VAN_abbr621ts$value)
#VAN_abbr621ts$ts<-as.POSIXct(VAN_abbr621ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_abbr621ts$ts<-parse_date_time(VAN_abbr621ts$ts,orders=c("dmy","dmy HMS"))
VAN_abbr621ts$yr<-format(VAN_abbr621ts$ts, "%Y")
VAN_abbr621ts$yr<-as.factor(VAN_abbr621ts$yr)


VAN_621ts<- read.csv("~/research2/TreeNetProc/TOMST/VAN/VAN_621_ts_DMY.csv",
                     stringsAsFactors = TRUE)
VAN_621ts$value<-as.numeric(VAN_621ts$value)
#VAN_621ts$ts<-as.POSIXct(VAN_621ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_621ts$ts<-parse_date_time(VAN_621ts$ts,orders=c("dmy","dmy HMS"))
VAN_621ts$yr<-format(VAN_621ts$ts, "%Y")
VAN_621ts$yr<-as.factor(VAN_621ts$yr)


VAN_622ts<- read.csv("~/research2/TreeNetProc/TOMST/VAN/VAN_622_ts_DMY.csv",
                     stringsAsFactors = TRUE)
VAN_622ts$value<-as.numeric(VAN_622ts$value)
#VAN_622ts$ts<-as.POSIXct(VAN_abbr622ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_622ts$ts<-parse_date_time(VAN_622ts$ts,orders=c("dmy","dmy HMS"))
VAN_622ts$yr<-format(VAN_622ts$ts, "%Y")
VAN_622ts$yr<-as.factor(VAN_622ts$yr)
```

```{r}
ggplot(DT311ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT311 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()
```


tHINK ABOUT DOING A FILTER FOR SCREENING AND KEEPING ONLY TOP 10% FOR 646 FOR EXAMPLE  also something like a low pass filter that only lets low values pass through also option for top 90th percentile 
Run again and only have growing szn in another plots but KEEP EVERYTHING FIOR THESIS kEEP IN mind differences in species potentials 
van is a higher elevation site and is a solid month behind others in terms of when growth starts 

Next up: di other accumuulatioins like growing degree days (typical for initiating growth) look at email and papers bc in one of them maurice cabban spanniard they talk about temoerature for initiaiting growth and how it can be good modeled. look at other apers by connie harringtoni on modeled df growth; look at r routine that adam used to model bud burst and can do growth initiation - put this equation into r to predict start of growth and compare to what the dendros say instead kevin ford lead author on poth and connie senior authir pn all "will cahnges in ophenology track climate change? coastal df"
Global Change Biology (2016) 22, 3712–3723, doi: 10.1111/gcb.13328
equation 2 modeling growth initiation dates and plotted in figure 2 - READ THIS! THESE arew the kinds olf questions ill be asked in qualifying exams and such 

good to show growth and relationship btv modeled initiation stuff ??? maybe we can make a similar equation for WH but maybe connie has done this so in january remind chris tro meet with her 

make separate folders for each tree 

#Finding initiating points of growth
From Beedlow et al 2013: 
A soil temperature growth threshold of ∼5 °C has been shown for Douglas-fir (Bailey and Harrington, 2006, Emmingham, 1977) and other northern hemisphere conifer species (Deslauriers et al., 2003b, Rossi et al., 2007, Shönenberger and Frey, 1988). Growth was assumed not to occur when the average soil temperature was <5 °C.
```{r}
PrimetTOMSTsoil<-PrimetTOMST|>select(ts,SOILTEMP_MEAN_0_10_01,Flag_SOILTEMP_MEAN_0_10_01)|>filter(SOILTEMP_MEAN_0_10_01>=5)
```



#Step 2: Getting initial raw plots
```{r}
ggplot(CEN5180ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN5180 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()

ggplot(CEN8642ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN8642 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(DT311ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT311 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(DT646ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT646 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(DT655ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT655 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQRIP112ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP112 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQRIP113ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP113 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQRIP116ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP116 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP118ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP118 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP119ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP119 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP121ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP121 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP122ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP122 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP2577ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP2577 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC07_5231ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5231 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC07_5445ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5445 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC09_3936ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_3936 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC09_4502ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_4502 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20LWS_base_ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_base Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20LWS_branch_ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_branch Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20LWS_midcanopy_ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_midcanopy Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20TSHE_5523ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_5523 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20TSHE_624ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_624 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()

ggplot(RS20TSHE_625ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_625 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_660ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_660 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_662ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_662 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_664ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_664 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_665ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_665 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_7297ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_7297 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_abbr7297ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_abbr7297 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(VAN_621ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_621 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(VAN_abbr621ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_abbr621 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(VAN_622ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_622 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()
```

#Comparing with Precip
```{r}
#Merge dataframes and format style, datapoints, and organization
CEN5180TOMST<-full_join(CEN5180ts,CENMETaccprecip,by="ts")
CEN5180TOMST$ts<-as.Date(CEN5180TOMST$ts)
CEN5180TOMST$DOY<-yday(CEN5180TOMST$ts)
CEN5180TOMST$Expansion<-as.numeric(CEN5180TOMST$value) 
CEN5180TOMST|> mutate(across(everything(), as.numeric))
cleanCEN5180TOMST<- na.omit(CEN5180TOMST)
cleanCEN5180TOMST<-cleanCEN5180TOMST|>mutate(Expansion2 = Expansion + 0.0)

#cleanCEN5180TOMST |>
#  pivot_longer(cols = c(Expansion2, cleanCEN5180TOMST$PRECIP_ACC_455_0_01), 
#               names_to = "variable", 
#               values_to = "bothvariables")+values_transform = #list(bothvariables = as.numeric)

#UNSURE WHY ABOVE IS NOT WORKING SO IGNORED FOR NOW

#Plot NEED ABOVE TO WORK SO ALSO IGNORED FOR NOW
#ggplot(cleanCEN5180TOMST_long,
#       aes(x=ts,
#           y=bothvariables,
#           color=variable))+geom_point(alpha = 0.75) +
#  labs(title="CEN5180 Stem Diameter Changes & Accumulated #Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. #(mm)",color="Legend")+
#  scale_x_date(
#    breaks = "1 month",  # Every month
#    labels = date_format("%b\n%Y")) + #line break for month and year
#  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
CEN8642TOMST<-full_join(CEN8642ts,CENMETaccprecip,by="ts")
CEN8642TOMST$ts<-as.Date(CEN8642TOMST$ts)
CEN8642TOMST$DOY<-yday(CEN8642TOMST$ts)
CEN8642TOMST$Expansion<-CEN8642TOMST$value
cleanCEN8642TOMST<- na.omit(CEN8642TOMST)
cleanCEN8642TOMST_long <- cleanCEN8642TOMST |>
  pivot_longer(cols = c(Expansion, PRECIP_ACC_455_0_01), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanCEN8642TOMST_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="CEN8642 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetDT311<-full_join(DT311ts,PrimetTOMST,by="ts")
PrimetDT311$ts<-as.Date(PrimetDT311$ts)
PrimetDT311$DOY<-yday(PrimetDT311$ts)
PrimetDT311$Expansion<-PrimetDT311$value
cleanPrimetDT311<- na.omit(PrimetDT311)
cleanPrimetDT311_long <- cleanPrimetDT311 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetDT311_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="DT311 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetDT646<-full_join(DT646ts,PrimetTOMST,by="ts")
PrimetDT646$ts<-as.Date(PrimetDT646$ts)
PrimetDT646$DOY<-yday(PrimetDT646$ts)
PrimetDT646$Expansion<-PrimetDT646$value
cleanPrimetDT646<- na.omit(PrimetDT646)
cleanPrimetDT646_long <- cleanPrimetDT646 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetDT646_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="DT646 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetDT655<-full_join(DT655ts,PrimetTOMST,by="ts")
PrimetDT655$ts<-as.Date(PrimetDT655$ts)
PrimetDT655$DOY<-yday(PrimetDT655$ts)
PrimetDT655$Expansion<-PrimetDT655$value
cleanPrimetDT655<- na.omit(PrimetDT655)
cleanPrimetDT655_long <- cleanPrimetDT655 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetDT655_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="DT655 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQRIP112<-full_join(HQRIP112ts,PrimetTOMST,by="ts")
PrimetHQRIP112$ts<-as.Date(PrimetHQRIP112$ts)
PrimetHQRIP112$DOY<-yday(PrimetHQRIP112$ts)
PrimetHQRIP112$Expansion<-PrimetHQRIP112$value
cleanPrimetHQRIP112<- na.omit(PrimetHQRIP112)
cleanPrimetHQRIP112_long <- cleanPrimetHQRIP112 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQRIP112_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQRIP112 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQRIP113<-full_join(HQRIP113ts,PrimetTOMST,by="ts")
PrimetHQRIP113$ts<-as.Date(PrimetHQRIP113$ts)
PrimetHQRIP113$DOY<-yday(PrimetHQRIP113$ts)
PrimetHQRIP113$Expansion<-PrimetHQRIP113$value
cleanPrimetHQRIP113<- na.omit(PrimetHQRIP113)
cleanPrimetHQRIP113_long <- cleanPrimetHQRIP113 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQRIP113_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQRIP113 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQRIP116<-full_join(HQRIP116ts,PrimetTOMST,by="ts")
PrimetHQRIP116$ts<-as.Date(PrimetHQRIP116$ts)
PrimetHQRIP116$DOY<-yday(PrimetHQRIP116$ts)
PrimetHQRIP116$Expansion<-PrimetHQRIP116$value
cleanPrimetHQRIP116<- na.omit(PrimetHQRIP116)
cleanPrimetHQRIP116_long <- cleanPrimetHQRIP116 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQRIP116_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQRIP116 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQSWP118<-full_join(HQSWP118ts,PrimetTOMST,by="ts")
PrimetHQSWP118$ts<-as.Date(PrimetHQSWP118$ts)
PrimetHQSWP118$DOY<-yday(PrimetHQSWP118$ts)
PrimetHQSWP118$Expansion<-PrimetHQSWP118$value
cleanPrimetHQSWP118<- na.omit(PrimetHQSWP118)
cleanPrimetHQSWP118_long <- cleanPrimetHQSWP118 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQSWP118_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQSWP118 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQSWP119<-full_join(HQSWP119ts,PrimetTOMST,by="ts")
PrimetHQSWP119$ts<-as.Date(PrimetHQSWP119$ts)
PrimetHQSWP119$DOY<-yday(PrimetHQSWP119$ts)
PrimetHQSWP119$Expansion<-PrimetHQSWP119$value
cleanPrimetHQSWP119<- na.omit(PrimetHQSWP119)
cleanPrimetHQSWP119_long <- cleanPrimetHQSWP119 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQSWP119_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQSWP119 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQSWP121<-full_join(HQSWP121ts,PrimetTOMST,by="ts")
PrimetHQSWP121$ts<-as.Date(PrimetHQSWP121$ts)
PrimetHQSWP121$DOY<-yday(PrimetHQSWP121$ts)
PrimetHQSWP121$Expansion<-PrimetHQSWP121$value
cleanPrimetHQSWP121<- na.omit(PrimetHQSWP121)
cleanPrimetHQSWP121_long <- cleanPrimetHQSWP121 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQSWP121_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQSWP121 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQSWP122<-full_join(HQSWP122ts,PrimetTOMST,by="ts")
PrimetHQSWP122$ts<-as.Date(PrimetHQSWP122$ts)
PrimetHQSWP122$DOY<-yday(PrimetHQSWP122$ts)
PrimetHQSWP122$Expansion<-PrimetHQSWP122$value
cleanPrimetHQSWP122<- na.omit(PrimetHQSWP122)
cleanPrimetHQSWP122_long <- cleanPrimetHQSWP122 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQSWP122_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQSWP122 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetHQSWP2577<-full_join(HQSWP2577ts,PrimetTOMST,by="ts")
PrimetHQSWP2577$ts<-as.Date(PrimetHQSWP2577$ts)
PrimetHQSWP2577$DOY<-yday(PrimetHQSWP2577$ts)
PrimetHQSWP2577$Expansion<-PrimetHQSWP2577$value
cleanPrimetHQSWP2577<- na.omit(PrimetHQSWP2577)
cleanPrimetHQSWP2577_long <- cleanPrimetHQSWP2577 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetHQSWP2577_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="HQSWP2577 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetPC07_5231<-full_join(PC07_5231ts,PrimetTOMST,by="ts")
PrimetPC07_5231$ts<-as.Date(PrimetPC07_5231$ts)
PrimetPC07_5231$DOY<-yday(PrimetPC07_5231$ts)
PrimetPC07_5231$Expansion<-PrimetPC07_5231$value
cleanPrimetPC07_5231<- na.omit(PrimetPC07_5231)
cleanPrimetPC07_5231_long <- cleanPrimetPC07_5231 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetPC07_5231_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="PC07_5231 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetPC07_5445<-full_join(PC07_5445ts,PrimetTOMST,by="ts")
PrimetPC07_5445$ts<-as.Date(PrimetPC07_5445$ts)
PrimetPC07_5445$DOY<-yday(PrimetPC07_5445$ts)
PrimetPC07_5445$Expansion<-PrimetPC07_5445$value
cleanPrimetPC07_5445<- na.omit(PrimetPC07_5445)
cleanPrimetPC07_5445_long <- cleanPrimetPC07_5445 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetPC07_5445_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="PC07_5445 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetPC09_3936<-full_join(PC09_3936ts,PrimetTOMST,by="ts")
PrimetPC09_3936$ts<-as.Date(PrimetPC09_3936$ts)
PrimetPC09_3936$DOY<-yday(PrimetPC09_3936$ts)
PrimetPC09_3936$Expansion<-PrimetPC09_3936$value
cleanPrimetPC09_3936<- na.omit(PrimetPC09_3936)
cleanPrimetPC09_3936_long <- cleanPrimetPC09_3936 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetPC09_3936_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="PC09_3936 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetPC09_4502<-full_join(PC09_4502ts,PrimetTOMST,by="ts")
PrimetPC09_4502$ts<-as.Date(PrimetPC09_4502$ts)
PrimetPC09_4502$DOY<-yday(PrimetPC09_4502$ts)
PrimetPC09_4502$Expansion<-PrimetPC09_4502$value
cleanPrimetPC09_4502<- na.omit(PrimetPC09_4502)
cleanPrimetPC09_4502_long <- cleanPrimetPC09_4502 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetPC09_4502_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="PC09_4502 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetRS20LWS_base_<-full_join(RS20LWS_base_ts,PrimetTOMST,by="ts")
PrimetRS20LWS_base_$ts<-as.Date(PrimetRS20LWS_base_$ts)
PrimetRS20LWS_base_$DOY<-yday(PrimetRS20LWS_base_$ts)
PrimetRS20LWS_base_$Expansion<-PrimetRS20LWS_base_$value
cleanPrimetRS20LWS_base_<- na.omit(PrimetRS20LWS_base_)
cleanPrimetRS20LWS_base__long <- cleanPrimetRS20LWS_base_ |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetRS20LWS_base__long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="RS20LWS_base Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetRS20LWS_branch_<-full_join(RS20LWS_branch_ts,PrimetTOMST,by="ts")
PrimetRS20LWS_branch_$ts<-as.Date(PrimetRS20LWS_branch_$ts)
PrimetRS20LWS_branch_$DOY<-yday(PrimetRS20LWS_branch_$ts)
PrimetRS20LWS_branch_$Expansion<-PrimetRS20LWS_branch_$value
cleanPrimetRS20LWS_branch_<- na.omit(PrimetRS20LWS_branch_)
cleanPrimetRS20LWS_branch__long <- cleanPrimetRS20LWS_branch_ |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetRS20LWS_branch__long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="RS20LWS_branch Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetRS20LWS_midcanopy_<-full_join(RS20LWS_midcanopy_ts,PrimetTOMST,by="ts")
PrimetRS20LWS_midcanopy_$ts<-as.Date(PrimetRS20LWS_midcanopy_$ts)
PrimetRS20LWS_midcanopy_$DOY<-yday(PrimetRS20LWS_midcanopy_$ts)
PrimetRS20LWS_midcanopy_$Expansion<-PrimetRS20LWS_midcanopy_$value
cleanPrimetRS20LWS_midcanopy_<- na.omit(PrimetRS20LWS_midcanopy_)
cleanPrimetRS20LWS_midcanopy__long <- cleanPrimetRS20LWS_midcanopy_ |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetRS20LWS_midcanopy__long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="RS20LWS_midcanopy Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetRS20TSHE_5523<-full_join(RS20TSHE_5523ts,PrimetTOMST,by="ts")
PrimetRS20TSHE_5523$ts<-as.Date(PrimetRS20TSHE_5523$ts)
PrimetRS20TSHE_5523$DOY<-yday(PrimetRS20TSHE_5523$ts)
PrimetRS20TSHE_5523$Expansion<-PrimetRS20TSHE_5523$value
cleanPrimetRS20TSHE_5523<- na.omit(PrimetRS20TSHE_5523)
cleanPrimetRS20TSHE_5523_long <- cleanPrimetRS20TSHE_5523 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetRS20TSHE_5523_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="RS20TSHE_5523 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetRS20TSHE_624<-full_join(RS20TSHE_624ts,PrimetTOMST,by="ts")
PrimetRS20TSHE_624$ts<-as.Date(PrimetRS20TSHE_624$ts)
PrimetRS20TSHE_624$DOY<-yday(PrimetRS20TSHE_624$ts)
PrimetRS20TSHE_624$Expansion<-PrimetRS20TSHE_624$value
cleanPrimetRS20TSHE_624<- na.omit(PrimetRS20TSHE_624)
cleanPrimetRS20TSHE_624_long <- cleanPrimetRS20TSHE_624 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetRS20TSHE_624_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="RS20TSHE_624 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetRS20TSHE_625<-full_join(RS20TSHE_625ts,PrimetTOMST,by="ts")
PrimetRS20TSHE_625$ts<-as.Date(PrimetRS20TSHE_625$ts)
PrimetRS20TSHE_625$DOY<-yday(PrimetRS20TSHE_625$ts)
PrimetRS20TSHE_625$Expansion<-PrimetRS20TSHE_625$value
cleanPrimetRS20TSHE_625<- na.omit(PrimetRS20TSHE_625)
cleanPrimetRS20TSHE_625_long <- cleanPrimetRS20TSHE_625 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetRS20TSHE_625_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="RS20TSHE_625 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetUPLO_660<-full_join(UPLO_660ts,PrimetTOMST,by="ts")
PrimetUPLO_660$ts<-as.Date(PrimetUPLO_660$ts)
PrimetUPLO_660$DOY<-yday(PrimetUPLO_660$ts)
PrimetUPLO_660$Expansion<-PrimetUPLO_660$value
cleanPrimetUPLO_660<- na.omit(PrimetUPLO_660)
cleanPrimetUPLO_660_long <- cleanPrimetUPLO_660 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetUPLO_660_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="UPLO_660 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetUPLO_662<-full_join(UPLO_662ts,PrimetTOMST,by="ts")
PrimetUPLO_662$ts<-as.Date(PrimetUPLO_662$ts)
PrimetUPLO_662$DOY<-yday(PrimetUPLO_662$ts)
PrimetUPLO_662$Expansion<-PrimetUPLO_662$value
cleanPrimetUPLO_662<- na.omit(PrimetUPLO_662)
cleanPrimetUPLO_662_long <- cleanPrimetUPLO_662 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetUPLO_662_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="UPLO_662 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetUPLO_664<-full_join(UPLO_664ts,PrimetTOMST,by="ts")
PrimetUPLO_664$ts<-as.Date(PrimetUPLO_664$ts)
PrimetUPLO_664$DOY<-yday(PrimetUPLO_664$ts)
PrimetUPLO_664$Expansion<-PrimetUPLO_664$value
cleanPrimetUPLO_664<- na.omit(PrimetUPLO_664)
cleanPrimetUPLO_664_long <- cleanPrimetUPLO_664 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetUPLO_664_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="UPLO_664 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetUPLO_665<-full_join(UPLO_665ts,PrimetTOMST,by="ts")
PrimetUPLO_665$ts<-as.Date(PrimetUPLO_665$ts)
PrimetUPLO_665$DOY<-yday(PrimetUPLO_665$ts)
PrimetUPLO_665$Expansion<-PrimetUPLO_665$value
cleanPrimetUPLO_665<- na.omit(PrimetUPLO_665)
cleanPrimetUPLO_665_long <- cleanPrimetUPLO_665 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetUPLO_665_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="UPLO_665 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetUPLO_7297<-full_join(UPLO_7297ts,PrimetTOMST,by="ts")
PrimetUPLO_7297$ts<-as.Date(PrimetUPLO_7297$ts)
PrimetUPLO_7297$DOY<-yday(PrimetUPLO_7297$ts)
PrimetUPLO_7297$Expansion<-PrimetUPLO_7297$value
cleanPrimetUPLO_7297<- na.omit(PrimetUPLO_7297)
cleanPrimetUPLO_7297_long <- cleanPrimetUPLO_7297 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetUPLO_7297_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="UPLO_7297 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetUPLO_abbr7297<-full_join(UPLO_abbr7297ts,PrimetTOMST,by="ts")
PrimetUPLO_abbr7297$ts<-as.Date(PrimetUPLO_abbr7297$ts)
PrimetUPLO_abbr7297$DOY<-yday(PrimetUPLO_abbr7297$ts)
PrimetUPLO_abbr7297$Expansion<-PrimetUPLO_abbr7297$value
cleanPrimetUPLO_abbr7297<- na.omit(PrimetUPLO_abbr7297)
cleanPrimetUPLO_abbr7297_long <- cleanPrimetUPLO_abbr7297 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetUPLO_abbr7297_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="UPLO_abbr7297 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetVAN_621<-full_join(VAN_621ts,PrimetTOMST,by="ts")
PrimetVAN_621$ts<-as.Date(PrimetVAN_621$ts)
PrimetVAN_621$DOY<-yday(PrimetVAN_621$ts)
PrimetVAN_621$Expansion<-PrimetVAN_621$value
cleanPrimetVAN_621<- na.omit(PrimetVAN_621)
cleanPrimetVAN_621_long <- cleanPrimetVAN_621 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetVAN_621_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="VAN_621 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetVAN_abbr621<-full_join(VAN_abbr621ts,PrimetTOMST,by="ts")
PrimetVAN_abbr621$ts<-as.Date(PrimetVAN_abbr621$ts)
PrimetVAN_abbr621$DOY<-yday(PrimetVAN_abbr621$ts)
PrimetVAN_abbr621$Expansion<-PrimetVAN_abbr621$value
cleanPrimetVAN_abbr621<- na.omit(PrimetVAN_abbr621)
cleanPrimetVAN_abbr621_long <- cleanPrimetVAN_abbr621 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetVAN_abbr621_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="VAN_abbr621 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size






#Merge dataframes and format style, datapoints, and organization
PrimetVAN_622<-full_join(VAN_622ts,PrimetTOMST,by="ts")
PrimetVAN_622$ts<-as.Date(PrimetVAN_622$ts)
PrimetVAN_622$DOY<-yday(PrimetVAN_622$ts)
PrimetVAN_622$Expansion<-PrimetVAN_622$value
cleanPrimetVAN_622<- na.omit(PrimetVAN_622)
cleanPrimetVAN_622_long <- cleanPrimetVAN_622 |>
  pivot_longer(cols = c(Expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")
#Plot
ggplot(cleanPrimetVAN_622_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.75) +
  labs(title="VAN_622 Stem Diameter Changes & Accumulated Precip.",x="Date",y="Stem Diameter Change (µm); Accu. Precip. (mm)",color="Legend")+
  scale_x_date(
    breaks = "1 month",  # Every month
    labels = date_format("%b\n%Y")) + #line break for month and year
  theme(axis.text.x = element_text(size = 7.5)) # Axis text size

```

##Step 2.5: Isolating trees that have October '24 cores and zooming in on growing season

```{r}
#Primet311<-full_join(DT311ts,PrimetTOMST,by="ts")
#Primet311$DOY<-yday(Primet311$ts)

Primet311$PRECIP_TOT_100_0_01[Primet311$Flag_PRECIP_TOT_100_0_01=="Q"] <- NA
Primet311$PRECIP_ACC_100_0_01[Primet311$Flag_PRECIP_ACC_100_0_01=="Q"] <- NA
cleanPrimet311<- na.omit(Primet311)
ggplot(cleanPrimet311,aes(x=DOY,y=cleanPrimet311$PRECIP_ACC_100_0_01,color=yr))+geom_point(na.rm=TRUE)
ggplot(cleanPrimet311,aes(x=DOY,y=cleanPrimet311$PRECIP_TOT_100_0_01,color=yr))+geom_point(na.rm=TRUE)



cleanPrimet311$AccPrecip<-
  cleanPrimet311$PRECIP_ACC_100_0_01
cleanPrimet311$expansion<-cleanPrimet311$value

library(tidyr)
cleanPrimet311_long <- cleanPrimet311 |>
  pivot_longer(cols = c(expansion, AccPrecip), 
               names_to = "variable", 
               values_to = "bothvariables")

ggplot(cleanPrimet311_long,
       aes(x=ts,
           y=bothvariables,
           color=variable))+geom_point(alpha = 0.7) +
  scale_x_datetime(
    breaks = "1 month",  # Every month
    date_labels = "%b") +
  theme(axis.text.x = element_text(size = 7)) # Every month

```

```{r}
DT311ts$DOY<-yday(DT311ts$ts)
ggplot(DT311ts,aes(x=DOY,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT311 Stem Diameter Changes",x="Day of Year",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 


DT646ts$DOY<-yday(DT646ts$ts)
ggplot(DT646ts,aes(x=DOY,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT646 Stem Diameter Changes",x="Day of Year",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 

DT646ts$DOY<-yday(DT646ts$ts)

DT655ts$DOY<-yday(DT655ts$ts)
ggplot(DT655ts,aes(x=DOY,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT655 Stem Diameter Changes",x="Day of Year",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 

HQSWP2577ts$DOY<-yday(HQSWP2577ts$ts)
ggplot(HQSWP2577ts,aes(x=DOY,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP2577 Stem Diameter Changes",x="Day of Year",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 
```



##Step 3: Reading in and formatting temperature data 

```{r}
CEN5180temp<- read.csv("~/research2/TreeNetProc/TOMST/CENMET/CEN_5180_temp.csv",stringsAsFactors = TRUE)
CEN5180temp$value<-as.numeric(CEN5180temp$value)
CEN5180temp$ts<-parse_date_time(CEN5180temp$ts,orders=c("dmy","dmy HMS"))
CEN5180temp$yr<-format(CEN5180temp$ts, "%Y")
CEN5180temp$yr<-as.factor(CEN5180temp$yr)
write.csv(file="CEN5180temp.csv",CEN5180temp)


CEN8642temp<- read.csv("~/research2/TreeNetProc/TOMST/CENMET/CEN_8642_temp.csv",stringsAsFactors = TRUE)
CEN8642temp$value<-as.numeric(CEN8642temp$value)
CEN8642temp$ts<-parse_date_time(CEN8642temp$ts,orders=c("dmy","dmy HMS"))
CEN8642temp$yr<-as.factor(format(CEN8642temp$ts, "%Y"))


DT311temp <- read.csv("~/research2/TreeNetProc/TOMST/DT/DT311temp.csv", stringsAsFactors=TRUE)
DT311temp$ts<-DT311temp$datetime
DT311temp$value<-as.numeric(DT311temp$temp)
DT311temp$ts <- as.POSIXct(DT311temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT311temp$ts<-parse_date_time(DT311temp$ts,orders=c("ymd","ymd HMS"))
DT311temp$yr<-format(DT311temp$ts, "%Y")
DT311temp$yr<-as.factor(DT311temp$yr)


DT646temp <- read.csv("~/research2/TreeNetProc/TOMST/DT/DT646temp.csv", stringsAsFactors=TRUE)
DT646temp$ts<-DT646temp$datetime
DT646temp$value<-as.numeric(DT646temp$temp)
DT646temp$ts <- as.POSIXct(DT646temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT646temp$ts<-parse_date_time(DT646temp$ts,orders=c("ymd","ymd HMS"))
DT646temp$yr<-format(DT646temp$ts, "%Y")
DT646temp$yr<-as.factor(DT646temp$yr)


DT655temp <- read.csv("~/research2/TreeNetProc/TOMST/DT/DT655temp.csv", stringsAsFactors=TRUE)
DT655temp$ts<-DT655temp$datetime
DT655temp$value<-as.numeric(DT655temp$temp)
DT655temp$ts <- as.POSIXct(DT655temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT655temp$ts<-parse_date_time(DT655temp$ts,orders=c("ymd","ymd HMS"))
DT655temp$yr<-format(DT655temp$ts, "%Y")
DT655temp$yr<-as.factor(DT655temp$yr)


HQRIP112temp<- read.csv("~/research2/TreeNetProc/TOMST/HQRIP/HQRIP_112_temp.csv", stringsAsFactors = TRUE)
HQRIP112temp$value<-as.numeric(HQRIP112temp$value)
HQRIP112temp$ts <- as.POSIXct(HQRIP112temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP112temp$ts<-parse_date_time(HQRIP112temp$ts,orders=c("ymd","ymd HMS"))
HQRIP112temp$yr<-format(HQRIP112temp$ts, "%Y")
HQRIP112temp$yr<-as.factor(HQRIP112temp$yr)


HQRIP113temp<- read.csv("~/research2/TreeNetProc/TOMST/HQRIP/HQRIP_113_temp.csv",stringsAsFactors = TRUE)
HQRIP113temp$value<-as.numeric(HQRIP113temp$value)
HQRIP113temp$ts <- as.POSIXct(HQRIP113temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP113temp$ts<-parse_date_time(HQRIP113temp$ts,orders=c("ymd","ymd HMS"))
HQRIP113temp$yr<-format(HQRIP113temp$ts, "%Y")
HQRIP113temp$yr<-as.factor(HQRIP113temp$yr)


HQRIP116temp<- read.csv("~/research2/TreeNetProc/TOMST/HQRIP/HQRIP_116_temp.csv",stringsAsFactors = TRUE)
HQRIP116temp$value<-as.numeric(HQRIP116temp$value)
HQRIP116temp$ts <- as.POSIXct(HQRIP116temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP116temp$ts<-parse_date_time(HQRIP116temp$ts,orders=c("ymd","ymd HMS"))
HQRIP116temp$yr<-format(HQRIP116temp$ts, "%Y")
HQRIP116temp$yr<-as.factor(HQRIP116temp$yr)


HQSWP118temp<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_118_temp.csv", stringsAsFactors = TRUE)
HQSWP118temp$value<-as.numeric(HQSWP118temp$value)
HQSWP118temp$ts <- as.POSIXct(HQSWP118temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP118temp$ts<-parse_date_time(HQSWP118temp$ts,orders=c("ymd","ymd HMS"))
HQSWP118temp$yr<-format(HQSWP118temp$ts, "%Y")
HQSWP118temp$yr<-as.factor(HQSWP118temp$yr)


HQSWP119temp<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_119_temp.csv", stringsAsFactors = TRUE)
HQSWP119temp$value<-as.numeric(HQSWP119temp$value)
HQSWP119temp$ts <- as.POSIXct(HQSWP119temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP119temp$ts<-parse_date_time(HQSWP119temp$ts,orders=c("ymd","ymd HMS"))
HQSWP119temp$yr<-format(HQSWP119temp$ts, "%Y")
HQSWP119temp$yr<-as.factor(HQSWP119temp$yr)


HQSWP122temp<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_122_temp.csv",stringsAsFactors = TRUE)
HQSWP122temp$value<-as.numeric(HQSWP122temp$value)
HQSWP122temp$ts <- as.POSIXct(HQSWP122temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP122temp$ts<-parse_date_time(HQSWP122temp$ts,orders=c("ymd","ymd HMS"))
HQSWP122temp$yr<-format(HQSWP122temp$ts, "%Y")
HQSWP122temp$yr<-as.factor(HQSWP122temp$yr)


HQSWP2577temp<- read.csv("~/research2/TreeNetProc/TOMST/HQSWP/HQSWP_2577_temp.csv", stringsAsFactors = TRUE)
HQSWP2577temp$value<-as.numeric(HQSWP2577temp$value)
HQSWP2577temp$ts <- as.POSIXct(HQSWP2577temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP2577temp$ts<-parse_date_time(HQSWP2577temp$ts,orders=c("ymd","ymd HMS"))
HQSWP2577temp$yr<-format(HQSWP2577temp$ts, "%Y")
HQSWP2577temp$yr<-as.factor(HQSWP2577temp$yr)


PC07_5231temp<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC07_5231_temp.csv", stringsAsFactors = TRUE)
PC07_5231temp$value<-as.numeric(PC07_5231temp$value)
#PC07_5231temp$ts <- as.POSIXct(PC07_5231temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5231temp$ts<-parse_date_time(PC07_5231temp$ts,orders=c("dmy","dmy HMS"))
PC07_5231temp$yr<-format(PC07_5231temp$ts, "%Y")
PC07_5231temp$yr<-as.factor(PC07_5231temp$yr)


PC07_5445temp<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC07_5445_temp.csv",stringsAsFactors = TRUE)
PC07_5445temp$value<-as.numeric(PC07_5445temp$value)
#PC07_5445temp$ts <- as.POSIXct(PC07_5445temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5445temp$ts<-parse_date_time(PC07_5445temp$ts,orders=c("dmy","dmy HMS"))
PC07_5445temp$yr<-format(PC07_5445temp$ts, "%Y")
PC07_5445temp$yr<-as.factor(PC07_5445temp$yr)


PC09_3936temp<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC09_3936_temp.csv",stringsAsFactors = TRUE)
PC09_3936temp$value<-as.numeric(PC09_3936temp$value)
#PC09_3936temp$ts <- as.POSIXct(PC09_3936temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_3936temp$ts<-parse_date_time(PC09_3936temp$ts,orders=c("dmy","dmy HMS"))
PC09_3936temp$yr<-format(PC09_3936temp$ts, "%Y")
PC09_3936temp$yr<-as.factor(PC09_3936temp$yr)


PC09_4502temp<- read.csv("~/research2/TreeNetProc/TOMST/PC/PC09_4502_temp.csv",stringsAsFactors = TRUE)
PC09_4502temp$value<-as.numeric(PC09_4502temp$value)
#PC09_4502temp$ts <- as.POSIXct(PC09_4502temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_4502temp$ts<-parse_date_time(PC09_4502temp$ts,orders=c("dmy","dmy HMS"))
PC09_4502temp$yr<-format(PC09_4502temp$ts, "%Y")
PC09_4502temp$yr<-as.factor(PC09_4502temp$yr)


RS20TSHE_624temp<-read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_TSHE_624_temp.csv", stringsAsFactors = TRUE)
RS20TSHE_624temp$value<-as.numeric(RS20TSHE_624temp$value)
RS20TSHE_624temp$ts <- as.POSIXct(RS20TSHE_624temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_624temp$ts<-parse_date_time(RS20TSHE_624temp$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_624temp$yr<-format(RS20TSHE_624temp$ts, "%Y")
RS20TSHE_624temp$yr<-as.factor(RS20TSHE_624temp$yr)


RS20TSHE_625temp<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_TSHE_625_temp.csv",
stringsAsFactors = TRUE)
RS20TSHE_625temp$value<-as.numeric(RS20TSHE_625temp$value)
RS20TSHE_625temp$ts <- as.POSIXct(RS20TSHE_625temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_625temp$ts<-parse_date_time(RS20TSHE_625temp$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_625temp$yr<-format(RS20TSHE_625temp$ts, "%Y")
RS20TSHE_625temp$yr<-as.factor(RS20TSHE_625temp$yr)


RS20TSHE_5523temp<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20_TSHE_5523_temp.csv",
                     stringsAsFactors = TRUE)
RS20TSHE_5523temp$value<-as.numeric(RS20TSHE_5523temp$value)
RS20TSHE_5523temp$ts <- as.POSIXct(RS20TSHE_5523temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_5523temp$ts<-parse_date_time(RS20TSHE_5523temp$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_5523temp$yr<-format(RS20TSHE_5523temp$ts, "%Y")
RS20TSHE_5523temp$yr<-as.factor(RS20TSHE_5523temp$yr)


RS20LWS_base_temp<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20LWS_base_temp.csv",
                     stringsAsFactors = TRUE)
RS20LWS_base_temp$value<-as.numeric(RS20LWS_base_temp$value)
RS20LWS_base_temp$ts <- as.POSIXct(RS20LWS_base_temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_base_temp$ts<-parse_date_time(RS20LWS_base_temp$ts,orders=c("ymd","ymd HMS"))
RS20LWS_base_temp$yr<-format(RS20LWS_base_temp$ts, "%Y")
RS20LWS_base_temp$yr<-as.factor(RS20LWS_base_temp$yr)


RS20LWS_branch_temp<- read.csv("~/research2/TreeNetProc/TOMST/RS/RS20LWS_branch_temp.csv",
                     stringsAsFactors = TRUE)
RS20LWS_branch_temp$value<-as.numeric(RS20LWS_branch_temp$value)
RS20LWS_branch_temp$ts <- as.POSIXct(RS20LWS_branch_temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_branch_temp$ts<-parse_date_time(RS20LWS_branch_temp$ts,orders=c("ymd","ymd HMS"))
RS20LWS_branch_temp$yr<-format(RS20LWS_branch_temp$ts, "%Y")
RS20LWS_branch_temp$yr<-as.factor(RS20LWS_branch_temp$yr)


RS20LWS_midcanopy_temp<-read.csv("~/research2/TreeNetProc/TOMST/RS/RS20LWS_midcanopy_temp.csv",stringsAsFactors = TRUE)
RS20LWS_midcanopy_temp$value<-as.numeric(RS20LWS_midcanopy_temp$value)
RS20LWS_midcanopy_temp$ts <- as.POSIXct(RS20LWS_midcanopy_temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_midcanopy_temp$ts<-parse_date_time(RS20LWS_midcanopy_temp$ts,orders=c("ymd","ymd HMS"))
RS20LWS_midcanopy_temp$yr<-format(RS20LWS_midcanopy_temp$ts, "%Y")
RS20LWS_midcanopy_temp$yr<-as.factor(RS20LWS_midcanopy_temp$yr)


UPLO_660temp<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_660_temp.csv",stringsAsFactors = TRUE)
UPLO_660temp$value<-as.numeric(UPLO_660temp$value)
UPLO_660temp$ts <- as.POSIXct(UPLO_660temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_660temp$ts<-parse_date_time(UPLO_660temp$ts,orders=c("ymd","ymd HMS"))
UPLO_660temp$yr<-format(UPLO_660temp$ts, "%Y")
UPLO_660temp$yr<-as.factor(UPLO_660temp$yr)


UPLO_662temp<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_662_temp.csv",stringsAsFactors = TRUE)
UPLO_662temp$value<-as.numeric(UPLO_662temp$value)
UPLO_662temp$ts <- as.POSIXct(UPLO_662temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_662temp$ts<-parse_date_time(UPLO_662temp$ts,orders=c("ymd","ymd HMS"))
UPLO_662temp$yr<-format(UPLO_662temp$ts, "%Y")
UPLO_662temp$yr<-as.factor(UPLO_662temp$yr)


UPLO_664temp<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_664_temp.csv", stringsAsFactors = TRUE)
UPLO_664temp$value<-as.numeric(UPLO_664temp$value)
UPLO_664temp$ts <- as.POSIXct(UPLO_664temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_664temp$ts<-parse_date_time(UPLO_664temp$ts,orders=c("ymd","ymd HMS"))
UPLO_664temp$yr<-format(UPLO_664temp$ts, "%Y")
UPLO_664temp$yr<-as.factor(UPLO_664temp$yr)


UPLO_665temp<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_665_temp.csv",stringsAsFactors = TRUE)
UPLO_665temp$value<-as.numeric(UPLO_665temp$value)
UPLO_665temp$ts <- as.POSIXct(UPLO_665temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_665temp$ts<-parse_date_time(UPLO_665temp$ts,orders=c("ymd","ymd HMS"))
UPLO_665temp$yr<-format(UPLO_665temp$ts, "%Y")
UPLO_665temp$yr<-as.factor(UPLO_665temp$yr)


UPLO_abbr7297temp<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_7297_abbr_temp.csv",
                     stringsAsFactors = TRUE)
UPLO_abbr7297temp$value<-as.numeric(UPLO_abbr7297temp$value)
UPLO_abbr7297temp$ts <- as.POSIXct(UPLO_abbr7297temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_abbr7297temp$ts<-parse_date_time(UPLO_abbr7297temp$ts,orders=c("ymd","ymd HMS"))
UPLO_abbr7297temp$yr<-format(UPLO_abbr7297temp$ts, "%Y")
UPLO_abbr7297temp$yr<-as.factor(UPLO_abbr7297temp$yr)


UPLO_7297temp<- read.csv("~/research2/TreeNetProc/TOMST/UPLO/UPLO_7297_temp.csv",
                     stringsAsFactors = TRUE)
UPLO_7297temp$value<-as.numeric(UPLO_7297temp$value)
UPLO_7297temp$ts <- as.POSIXct(UPLO_7297temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_7297temp$ts<-parse_date_time(UPLO_7297temp$ts,orders=c("ymd","ymd HMS"))
UPLO_7297temp$yr<-format(UPLO_7297temp$ts, "%Y")
UPLO_7297temp$yr<-as.factor(UPLO_7297temp$yr)


VAN_abbr621temp<- read.csv("~/research2/TreeNetProc/TOMST/VAN/VAN_621_abbr_temp.csv",
                     stringsAsFactors = TRUE)
VAN_abbr621temp$value<-as.numeric(VAN_abbr621temp$value)
#VAN_abbr621temp$ts <- as.POSIXct(VAN_abbr621temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_abbr621temp$ts<-parse_date_time(VAN_abbr621temp$ts,orders=c("dmy","dmy HMS"))
VAN_abbr621temp$yr<-format(VAN_abbr621temp$ts, "%Y")
VAN_abbr621temp$yr<-as.factor(VAN_abbr621temp$yr)


VAN_621temp<- read.csv("~/research2/TreeNetProc/TOMST/VAN/VAN_621_temp.csv",
                     stringsAsFactors = TRUE)
VAN_621temp$value<-as.numeric(VAN_621temp$value)
#VAN_621temp$ts <- as.POSIXct(VAN_621temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_621temp$ts<-parse_date_time(VAN_621temp$ts,orders=c("dmy","dmy HMS"))
VAN_621temp$yr<-format(VAN_621temp$ts, "%Y")
VAN_621temp$yr<-as.factor(VAN_621temp$yr)


VAN_622temp<- read.csv("~/research2/TreeNetProc/TOMST/VAN/VAN_622_temp.csv",
                     stringsAsFactors = TRUE)
VAN_622temp$value<-as.numeric(VAN_622temp$value)
#VAN_622temp$ts <- as.POSIXct(VAN_622temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_622temp$ts<-parse_date_time(VAN_622temp$ts,orders=c("dmy","dmy HMS"))
VAN_622temp$yr<-format(VAN_622temp$temp, "%Y")
VAN_622temp$yr<-as.factor(VAN_622temp$yr)
```


##Step 4 SHOULD BE: time-align temperature data with proc_L1. Make sure the "reso" matches the time interval of the dendrometer data. 
However, in this file proc_L1 is not recognizing the defined time format. Thus, what is done below is adding columns to the dendro and temp objects so that proc_L2 thinks that L1 worked.

##Step 5: Proc_dendro_L2, which integrates L1-processed dendrometer readings with temperature, detects errors, corrects them and plots gro and twd by date.
more info here: ?treenetproc::proc_dendro_L2
Plots will be exported to working directory as pdf

Even though the formats are all the same, some (6) of the 30 dendrometers are not responding correctly to the L2 function, so those have been labeled as text not code so R will overlook it for now. This is true for:

HQRIP116
HQSWP121
RS20LWS_branch
RS20LWS_midcanopy
RS20TSHE_625
VAN_622

```{r}
CEN5180ts$series<-"CEN5180"
CEN5180temp$series<-"CEN5180"
CEN5180temp$version<-"N.A"

CEN5180_L2 <- proc_dendro_L2(dendro_L1 = CEN5180ts,temp_L1 = CEN5180temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "CEN5180", tz="GMT") 



CEN8642ts$series<-"CEN8642"
CEN8642temp$series<-"CEN8642"
CEN8642temp$version<-"N.A"

CEN8642_L2 <- proc_dendro_L2(dendro_L1 = CEN8642ts,temp_L1 = CEN8642temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "CEN8642", tz="GMT") 



DT311ts$series<-"DT311"
DT311temp$series<-"DT311"
DT311temp$version<-"N.A"

DT311_L2 <- proc_dendro_L2(dendro_L1 = DT311ts,temp_L1 = DT311temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "DT311", tz="GMT") 



DT646ts$series<-"DT646"
DT646temp$series<-"DT646"
DT646temp$version<-"N.A"

DT646_L2 <- proc_dendro_L2(dendro_L1 = DT646ts,temp_L1 = DT646temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "DT646", tz="GMT") 



DT655ts$series<-"DT655"
DT655temp$series<-"DT655"
DT655temp$version<-"N.A"

DT655_L2 <- proc_dendro_L2(dendro_L1 = DT655ts,temp_L1 = DT655temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "DT655", tz="GMT") 



HQRIP112ts$series<-"HQRIP112"
HQRIP112temp$series<-"HQRIP112"
HQRIP112temp$version<-"N.A"

HQRIP112_L2 <- proc_dendro_L2(dendro_L1 = HQRIP112ts,temp_L1 = HQRIP112temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQRIP112", tz="GMT") 



HQRIP113ts$series<-"HQRIP113"
HQRIP113temp$series<-"HQRIP113"
HQRIP113temp$version<-"N.A"

HQRIP113_L2 <- proc_dendro_L2(dendro_L1 = HQRIP113ts,temp_L1 = HQRIP113temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQRIP113", tz="GMT") 

HQRIP116ts$series<-"HQRIP116"
HQRIP116temp$series<-"HQRIP116"
HQRIP116temp$version<-"N.A"


#HQRIP116_L2 <- proc_dendro_L2(dendro_L1 = HQRIP116ts,temp_L1 = HQRIP116temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQRIP116", tz="GMT") 


HQSWP118ts$series<-"HQSWP118"
HQSWP118temp$series<-"HQSWP118"
HQSWP118temp$version<-"N.A"

HQSWP118_L2 <- proc_dendro_L2(dendro_L1 = HQSWP118ts,temp_L1 = HQSWP118temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP118", tz="GMT") 



HQSWP119ts$series<-"HQSWP119"
HQSWP119temp$series<-"HQSWP119"
HQSWP119temp$version<-"N.A"

HQSWP119_L2 <- proc_dendro_L2(dendro_L1 = HQSWP119ts,temp_L1 = HQSWP119temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP119", tz="GMT") 


HQSWP121ts$series<-"HQSWP121"
#remember that this dendrometer had bad temperature values so we will omit that from this L2 processing

#HQSWP121_L2 <- proc_dendro_L2(dendro_L1 = HQSWP121ts, temp_L1 = NULL,tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP121", tz="GMT")



HQSWP122ts$series<-"HQSWP122"
HQSWP122temp$series<-"HQSWP122"
HQSWP122temp$version<-"N.A"

HQSWP122_L2 <- proc_dendro_L2(dendro_L1 = HQSWP122ts,temp_L1 = HQSWP122temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP122", tz="GMT") 



HQSWP2577ts$series<-"HQSWP2577"
HQSWP2577temp$series<-"HQSWP2577"
HQSWP2577temp$version<-"N.A"

HQSWP2577_L2 <- proc_dendro_L2(dendro_L1 = HQSWP2577ts,temp_L1 = HQSWP2577temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP2577", tz="GMT") 



PC07_5231ts$series<-"PC07_5231"
PC07_5231temp$series<-"PC07_5231"
PC07_5231temp$version<-"N.A"

PC07_5231_L2 <- proc_dendro_L2(dendro_L1 = PC07_5231ts,temp_L1 = PC07_5231temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC07_5231", tz="GMT") 



PC07_5445ts$series<-"PC07_5445"
PC07_5445temp$series<-"PC07_5445"
PC07_5445temp$version<-"N.A"

PC07_5445_L2 <- proc_dendro_L2(dendro_L1 = PC07_5445ts,temp_L1 = PC07_5445temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC07_5445", tz="GMT") 



PC09_3936ts$series<-"PC09_3936"
PC09_3936temp$series<-"PC09_3936"
PC09_3936temp$version<-"N.A"

PC09_3936_L2 <- proc_dendro_L2(dendro_L1 = PC09_3936ts,temp_L1 = PC09_3936temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC09_3936", tz="GMT") 



PC09_4502ts$series<-"PC09_4502"
PC09_4502temp$series<-"PC09_4502"
PC09_4502temp$version<-"N.A"

PC09_4502_L2 <- proc_dendro_L2(dendro_L1 = PC09_4502ts,temp_L1 = PC09_4502temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC09_4502", tz="GMT") 



RS20LWS_base_ts$series<-"RS20LWS_base_"
RS20LWS_base_temp$series<-"RS20LWS_base_"
RS20LWS_base_temp$version<-"N.A"

RS20LWS_base_L2 <- proc_dendro_L2(dendro_L1 = RS20LWS_base_ts,temp_L1 = RS20LWS_base_temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20LWS_base_", tz="GMT") 



RS20LWS_branch_ts$series<-"RS20LWS_branch"
RS20LWS_branch_temp$series<-"RS20LWS_branch"
RS20LWS_branch_temp$version<-"N.A"

#RS20LWS_branch_L2 <- proc_dendro_L2(dendro_L1 = RS20LWS_branch_ts,temp_L1 = RS20LWS_branch_temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20LWS_branch_", tz="GMT") 



RS20LWS_midcanopy_ts$series<-"RS20LWS_midcanopy_"
RS20LWS_midcanopy_temp$series<-"RS20LWS_midcanopy_"
RS20LWS_midcanopy_temp$version<-"N.A"

#RS20LWS_midcanopy_L2 <- proc_dendro_L2(dendro_L1 = RS20LWS_midcanopy_ts,temp_L1 = RS20LWS_midcanopy_temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20LWS_midcanopy_", tz="GMT") 



RS20TSHE_5523ts$series<-"RS20TSHE_5523"
RS20TSHE_5523temp$series<-"RS20TSHE_5523"
RS20TSHE_5523temp$version<-"N.A"

RS20TSHE_5523_L2 <- proc_dendro_L2(dendro_L1 = RS20TSHE_5523ts,temp_L1 = RS20TSHE_5523temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20TSHE_5523", tz="GMT") 



RS20TSHE_624ts$series<-"RS20TSHE_624"
RS20TSHE_624temp$series<-"RS20TSHE_624"
RS20TSHE_624temp$version<-"N.A"

RS20TSHE_624_L2 <- proc_dendro_L2(dendro_L1 = RS20TSHE_624ts,temp_L1 = RS20TSHE_624temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20TSHE_624", tz="GMT") 



RS20TSHE_625ts$series<-"RS20TSHE_625"
RS20TSHE_625temp$series<-"RS20TSHE_625"
RS20TSHE_625temp$version<-"N.A"

#RS20TSHE_625_L2 <- proc_dendro_L2(dendro_L1 = RS20TSHE_625ts,temp_L1 = RS20TSHE_625temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20TSHE_625", tz="GMT") 



UPLO_660ts$series<-"UPLO_660"
UPLO_660temp$series<-"UPLO_660"
UPLO_660temp$version<-"N.A"

UPLO_660_L2 <- proc_dendro_L2(dendro_L1 = UPLO_660ts,temp_L1 = UPLO_660temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_660", tz="GMT") 



UPLO_662ts$series<-"UPLO_662"
UPLO_662temp$series<-"UPLO_662"
UPLO_662temp$version<-"N.A"

UPLO_662_L2 <- proc_dendro_L2(dendro_L1 = UPLO_662ts,temp_L1 = UPLO_662temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_662", tz="GMT") 



UPLO_664ts$series<-"UPLO_664"
UPLO_664temp$series<-"UPLO_664"
UPLO_664temp$version<-"N.A"

UPLO_664_L2 <- proc_dendro_L2(dendro_L1 = UPLO_664ts,temp_L1 = UPLO_664temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_664", tz="GMT") 



UPLO_665ts$series<-"UPLO_665"
UPLO_665temp$series<-"UPLO_665"
UPLO_665temp$version<-"N.A"

UPLO_665_L2 <- proc_dendro_L2(dendro_L1 = UPLO_665ts,temp_L1 = UPLO_665temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_665", tz="GMT") 



UPLO_7297ts$series<-"UPLO_7297"
UPLO_7297temp$series<-"UPLO_7297"
UPLO_7297temp$version<-"N.A"

UPLO_7297_L2 <- proc_dendro_L2(dendro_L1 = UPLO_7297ts,temp_L1 = UPLO_7297temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_7297", tz="GMT") 



UPLO_abbr7297ts$series<-"UPLO_abbr7297"
UPLO_abbr7297temp$series<-"UPLO_abbr7297"
UPLO_abbr7297temp$version<-"N.A"

UPLO_abbr7297_L2 <- proc_dendro_L2(dendro_L1 = UPLO_abbr7297ts,temp_L1 = UPLO_abbr7297temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_abbr7297", tz="GMT") 



VAN_621ts$series<-"VAN_621"
VAN_621temp$series<-"VAN_621"
VAN_621temp$version<-"N.A"

VAN_621_L2 <- proc_dendro_L2(dendro_L1 = VAN_621ts,temp_L1 = VAN_621temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "VAN_621", tz="GMT") 



VAN_622ts$series<-"VAN_622"
VAN_622temp$series<-"VAN_622"
VAN_622temp$version<-"N.A"

#VAN_622_L2 <- proc_dendro_L2(dendro_L1 = VAN_622ts,temp_L1 = VAN_622temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "VAN_622", tz="GMT") 



VAN_abbr621ts$series<-"VAN_abbr621"
VAN_abbr621temp$series<-"VAN_abbr621"
VAN_abbr621temp$version<-"N.A"

VAN_abbr621_L2 <- proc_dendro_L2(dendro_L1 = VAN_abbr621ts,temp_L1 = VAN_abbr621temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "VAN_abbr621", tz="GMT") 
```

#Getting Phase Stat Tables 
phase_stats calculates the timing, duration, amplitude and the rate of change of shrinkage and expansion phases. In addition, days on which radial change is likely driven by transpiration or temperature are identified.

shrink_dur/exp_dur	
duration (minutes) of the shrinkage or expansion phase.

shrink_amp/exp_amp	
amplitude (µm) of the shrinkage or expansion phase.

shrink_slope/exp_slope	
slope (µm * reso^-1) of the shrinkage or expansion phase.

phase_class	
days are classified as 1 if a shrinkage occurs during the day (and is likely driven by transpiration), and as -1 if there is an expansion during the day (likely driven by temperature). On all other days phase_class is set to NA.

In case data is not aggregated to daily values (agg_daily = FALSE), all columns are appended to the input data. All parameters related to shrinkage or expansion phases are pasted at the timestamp corresponding to the end of the respective phases (shrink_end or exp_end). All other rows are set to NA.

Need L2 processed data for this so the same dendrometers that had issues in L2 will be ignored here for now. These include: 
HQRIP116
HQSWP121
RS20LWS_branch
RS20LWS_midcanopy
RS20TSHE_625
VAN_622

Issue with PC09_4502 "need finite xlim values"
Issue with RS20TSHE_624: "no non-missing arguments to min; returning InfError in `dplyr::mutate()`:
ℹ In argument: `shrink_group = c(rep(1:floor(dplyr::n()/2), each
  = 2), NA)`.
Caused by error:
! `shrink_group` must be size 1, not 5."
```{r}
CEN5180phase_stats <- phase_stats(dendro_L2 = CEN5180_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(CEN5180phase_stats[1:5, ], caption = "CEN5180 Phase Stats")
write.csv(CEN5180phase_stats, file = "~/research2/TreeNetProc/TOMST/CENMET/CEN5180phase_stats.csv")


CEN8642phase_stats <- phase_stats(dendro_L2 = CEN8642_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(CEN8642phase_stats[1:5, ], caption = "CEN8642 Phase Stats")
write.csv(CEN8642phase_stats, file = "~/research2/TreeNetProc/TOMST/CENMET/CEN8642phase_stats.csv")


DT311phase_stats <- phase_stats(dendro_L2 = DT311_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(DT311phase_stats[1:5, ], caption = "DT311 Phase Stats")
write.csv(DT311phase_stats, file = "~/research2/TreeNetProc/TOMST/DT/DT311phase_stats.csv")


DT646phase_stats <- phase_stats(dendro_L2 = DT646_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(DT646phase_stats[1:5, ], caption = "DT646 Phase Stats")
write.csv(DT646phase_stats, file = "~/research2/TreeNetProc/TOMST/DT/DT646phase_stats.csv")


DT655phase_stats <- phase_stats(dendro_L2 = DT655_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(DT655phase_stats[1:5, ], caption = "DT655 Phase Stats")
write.csv(DT655phase_stats, file = "~/research2/TreeNetProc/TOMST/DT/DT655phase_stats.csv")


HQRIP112phase_stats <- phase_stats(dendro_L2 = HQRIP112_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(HQRIP112phase_stats[1:5, ], caption = "HQRIP112 Phase Stats")
write.csv(HQRIP112phase_stats, file = "~/research2/TreeNetProc/TOMST/HQRIP/HQRIP112phase_stats.csv")


HQRIP113phase_stats <- phase_stats(dendro_L2 = HQRIP113_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(HQRIP113phase_stats[1:5, ], caption = "HQRIP113 Phase Stats")
write.csv(HQRIP113phase_stats, file = "~/research2/TreeNetProc/TOMST/HQRIP/HQRIP113phase_stats.csv")


#HQRIP116phase_stats <- phase_stats(dendro_L2 = HQRIP116_L2, plot_phase = #TRUE, plot_export = TRUE)
#knitr::kable(HQRIP116phase_stats[1:5, ], caption = "HQRIP116 Phase Stats")
#write.csv(HQRIP116phase_stats, file = #"~/research2/TreeNetProc/TOMST/HQRIP/HQRIP116phase_stats.csv")


HQSWP118phase_stats <- phase_stats(dendro_L2 = HQSWP118_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(HQSWP118phase_stats[1:5, ], caption = "HQSWP118 Phase Stats")
write.csv(HQSWP118phase_stats, file = "~/research2/TreeNetProc/TOMST/HQSWP/HQSWP118phase_stats.csv")


HQSWP119phase_stats <- phase_stats(dendro_L2 = HQSWP119_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(HQSWP119phase_stats[1:5, ], caption = "HQSWP119 Phase Stats")
write.csv(HQSWP119phase_stats, file = "~/research2/TreeNetProc/TOMST/HQSWP/HQSWP119phase_stats.csv")


#HQSWP121phase_stats <- phase_stats(dendro_L2 = HQSWP121_L2, plot_phase = #TRUE, plot_export = TRUE)
#knitr::kable(HQSWP121phase_stats[1:5, ], caption = "HQSWP121 Phase Stats")
#write.csv(HQSWP121phase_stats, file = #"~/research2/TreeNetProc/TOMST/HQSWP/HQSWP121phase_stats.csv")


HQSWP122phase_stats <- phase_stats(dendro_L2 = HQSWP122_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(HQSWP122phase_stats[1:5, ], caption = "HQSWP122 Phase Stats")
write.csv(HQSWP122phase_stats, file = "~/research2/TreeNetProc/TOMST/HQSWP/HQSWP122phase_stats.csv")


HQSWP2577phase_stats <- phase_stats(dendro_L2 = HQSWP2577_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(HQSWP2577phase_stats[1:5, ], caption = "HQSWP2577 Phase Stats")
write.csv(HQSWP2577phase_stats, file = "~/research2/TreeNetProc/TOMST/HQSWP/HQSWP2577phase_stats.csv")


PC07_5231phase_stats <- phase_stats(dendro_L2 = PC07_5231_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(PC07_5231phase_stats[1:5, ], caption = "PC07_5231 Phase Stats")
write.csv(PC07_5231phase_stats, file = "~/research2/TreeNetProc/TOMST/PC/PC07_5231phase_stats.csv")


PC07_5445phase_stats <- phase_stats(dendro_L2 = PC07_5445_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(PC07_5445phase_stats[1:5, ], caption = "PC07_5445 Phase Stats")
write.csv(PC07_5445phase_stats, file = "~/research2/TreeNetProc/TOMST/PC/PC07_5445phase_stats.csv")


PC09_3936phase_stats <- phase_stats(dendro_L2 = PC09_3936_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(PC09_3936phase_stats[1:5, ], caption = "PC09_3936 Phase Stats")
write.csv(PC09_3936phase_stats, file = "~/research2/TreeNetProc/TOMST/PC/PC09_3936phase_stats.csv")


PC09_4502phase_stats <- phase_stats(dendro_L2 = PC09_4502_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(PC09_4502phase_stats[1:5, ], caption = "PC09_4502 Phase Stats")
write.csv(PC09_4502phase_stats, file = "~/research2/TreeNetProc/TOMST/PC/PC09_4502phase_stats.csv")



RS20LWS_basephase_stats <- phase_stats(dendro_L2 = RS20LWS_base_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(RS20LWS_basephase_stats[1:5, ], caption = "RS20LWS_base Phase Stats")
write.csv(RS20LWS_basephase_stats, file = "~/research2/TreeNetProc/TOMST/RS/RS20LWS_basephase_stats.csv")




#RS20LWS_branchphase_stats <- phase_stats(dendro_L2 = RS20LWS_branch_L2, #plot_phase = TRUE, plot_export = TRUE)
#knitr::kable(RS20LWS_branchphase_stats[1:5, ], caption = "RS20LWS_branch #Phase Stats")
#write.csv(RS20LWS_branchphase_stats, file = #"~/research2/TreeNetProc/TOMST/RS/RS20LWS_branchphase_stats.csv")


#RS20LWS_midcanopyphase_stats <- phase_stats(dendro_L2 = #RS20LWS_midcanopy_L2, plot_phase = TRUE, plot_export = TRUE)
#knitr::kable(RS20LWS_midcanopyphase_stats[1:5, ], caption = #"RS20LWS_midcanopy Phase Stats")
#write.csv(RS20LWS_midcanopyphase_stats, file = #"~/research2/TreeNetProc/TOMST/RS/RS20LWS_midcanopyphase_stats.csv")



RS20TSHE_5523phase_stats <- phase_stats(dendro_L2 = RS20TSHE_5523_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(RS20TSHE_5523phase_stats[1:5, ], caption = "RS20TSHE_5523 Phase Stats")
write.csv(RS20TSHE_5523phase_stats, file = "~/research2/TreeNetProc/TOMST/RS/RS20TSHE_5523phase_stats.csv")


RS20TSHE_624phase_stats <- phase_stats(dendro_L2 = RS20TSHE_624_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(RS20TSHE_624phase_stats[1:5, ], caption = "RS20TSHE_624 Phase Stats")
write.csv(RS20TSHE_624phase_stats, file = "~/research2/TreeNetProc/TOMST/RS/RS20TSHE_624phase_stats.csv")


#RS20TSHE_625phase_stats <- phase_stats(dendro_L2 = RS20TSHE_625_L2, #plot_phase = TRUE, plot_export = TRUE)
#knitr::kable(RS20TSHE_625phase_stats[1:5, ], caption = "RS20TSHE_625 Phase #Stats")
#write.csv(RS20TSHE_625phase_stats, file = #"~/research2/TreeNetProc/TOMST/RS/RS20TSHE_625phase_stats.csv")


UPLO_660phase_stats <- phase_stats(dendro_L2 = UPLO_660_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(UPLO_660phase_stats[1:5, ], caption = "UPLO_660 Phase Stats")
write.csv(UPLO_660phase_stats, file = "~/research2/TreeNetProc/TOMST/UPLO/UPLO_660phase_stats.csv")


UPLO_662phase_stats <- phase_stats(dendro_L2 = UPLO_662_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(UPLO_662phase_stats[1:5, ], caption = "UPLO_662 Phase Stats")
write.csv(UPLO_662phase_stats, file = "~/research2/TreeNetProc/TOMST/UPLO/UPLO_662phase_stats.csv")


UPLO_664phase_stats <- phase_stats(dendro_L2 = UPLO_664_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(UPLO_664phase_stats[1:5, ], caption = "UPLO_664 Phase Stats")
write.csv(UPLO_664phase_stats, file = "~/research2/TreeNetProc/TOMST/UPLO/UPLO_664phase_stats.csv")



UPLO_665phase_stats <- phase_stats(dendro_L2 = UPLO_665_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(UPLO_665phase_stats[1:5, ], caption = "UPLO_665 Phase Stats")
write.csv(UPLO_665phase_stats, file = "~/research2/TreeNetProc/TOMST/UPLO/UPLO_665phase_stats.csv")



UPLO_7297phase_stats <- phase_stats(dendro_L2 = UPLO_7297_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(UPLO_7297phase_stats[1:5, ], caption = "UPLO_7297 Phase Stats")
write.csv(UPLO_7297phase_stats, file = "~/research2/TreeNetProc/TOMST/UPLO/UPLO_7297phase_stats.csv")




UPLO_abbr7297phase_stats <- phase_stats(dendro_L2 = UPLO_abbr7297_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(UPLO_abbr7297phase_stats[1:5, ], caption = "UPLO_abbr7297 Phase Stats")
write.csv(UPLO_abbr7297phase_stats, file = "~/research2/TreeNetProc/TOMST/UPLO/UPLO_abbr7297phase_stats.csv")



VAN_621phase_stats <- phase_stats(dendro_L2 = VAN_621_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(VAN_621phase_stats[1:5, ], caption = "VAN_621 Phase Stats")
write.csv(VAN_621phase_stats, file = "~/research2/TreeNetProc/TOMST/VAN/VAN_621phase_stats.csv")



VAN_abbr621phase_stats <- phase_stats(dendro_L2 = VAN_abbr621_L2, plot_phase = TRUE, plot_export = TRUE)
knitr::kable(VAN_abbr621phase_stats[1:5, ], caption = "VAN_abbr621 Phase Stats")
write.csv(VAN_abbr621phase_stats, file = "~/research2/TreeNetProc/TOMST/VAN/VAN_abbr621phase_stats.csv")



#VAN_622phase_stats <- phase_stats(dendro_L2 = VAN_622_L2, plot_phase = TRUE, #plot_export = TRUE)
#knitr::kable(VAN_622phase_stats[1:5, ], caption = "VAN_622 Phase Stats")
#write.csv(VAN_622phase_stats, file = #"~/research2/TreeNetProc/TOMST/VAN/VAN_622phase_stats.csv")
```


first plot full dataset for dendrometer. Plot will be exported to working directory as pdf

##(OPTIONAL) Looking at this we can see that the tolerance for outliers and tolerance for jumps were set lower (more stringent) than default value. We can plot monthly instead and look at exported pdf for greater detail.


```{r}
#dend_L2_monthly <- proc_dendro_L2(dendro_L1 = dend_L1, temp_L1 = temp_data_L1, tol_out = 2, tol_jump = 3, frost_thr = 1, plot = TRUE, interpol = 3.5*60, plot_period = "monthly", plot_export = TRUE, plot_name = "dend310summer_monthly", tz="GMT") 
#graphics.off()
```

##(OPTIONAL) We can manually correct some areas where automated data cleaning was not up to snuff.

```{r}
#info on function here: ?corr_dendro_L2

#check errors in pdf and with this subset 
#dend_L2[which((dend_L2$flags)!="NA"),]

#highlight corrections made on the dendrometer data:
#(dend_L2[which(is.na(dend_L2$flags)==F),])
```


##(OPTIONAL) Calculating growing season start and end
For more infromation ?treenetproc::grow_seas

```{r}
grow_seas_L2 <- grow_seas(dendro_L2 = DT311_L2,agg_yearly=TRUE)
#knitr::kable(grow_seas_L2,caption = "Sample output data of the function `grow_seas`.")
```


## Step 6: plot L2 processed data!

```{r}
ggplot((subset(CEN5180_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="CEN5180 dendrometer values (gray), annual growth (green), twd (red)")

ggplot((subset(CEN8642_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="CEN8642")


ggplot((subset(DT311_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT311 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(DT646_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT646 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(DT655_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT655 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQRIP112_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQRIP112 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQRIP113_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQRIP113 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP118_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP118 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP119_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP119 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP122_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP122 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP2577_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP2577 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC07_5231_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC07_5231 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC07_5445_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC07_5445 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC09_3936_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC09_3936 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC09_4502_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC09_4502 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(RS20LWS_base__L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="RS20LWS_base dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(RS20TSHE_5523_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="RS20TSHE_5523 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(RS20TSHE_624_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="RS20TSHE_624 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_660_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_660 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_662_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_662 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_664_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_664 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_665_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_665 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_7297_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_7297 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_abbr7297_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_abbr7297 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(VAN_621_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="VAN_621 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(VAN_abbr621_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_line(aes(y=twd), color = "red")+labs(title="VAN_abbr621 dendrometer values (gray), annual growth (green), twd (red)")
```

#Isolating tree core dendors

```{r}
DT311_L2$DOY<-yday(DT311_L2$ts)
ggplot((subset(DT311_L2, frost == "FALSE")), aes(x=DOY))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT311 dendrometer values (gray), annual growth (green), twd (red)")+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 


DT646_L2$DOY<-yday(DT646_L2$ts)
ggplot((subset(DT646_L2, frost == "FALSE")), aes(x=DOY))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT646 dendrometer values (gray), annual growth (green), twd (red)")+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 


DT655_L2$DOY<-yday(DT655_L2$ts)
ggplot((subset(DT655_L2, frost == "FALSE")), aes(x=DOY))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT655 dendrometer values (gray), annual growth (green), twd (red)")+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 


HQSWP2577_L2$DOY<-yday(HQSWP2577_L2$ts)
ggplot((subset(HQSWP2577_L2, frost == "FALSE")), aes(x=DOY))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP2577 dendrometer values (gray), annual growth (green), twd (red)")+
  scale_x_continuous(
    limits=c(91,274),breaks = c(91,117,143,169,195,221,247,274), 
    labels = c(91,117,143,169,195,221,247,273),sec.axis = sec_axis(
      trans = ~ .,  # Identity transformation
      name = "Months",
      breaks = c(91,121,152,182,213,244,274),
      labels = c("Apr 1","May 1","Jun 1","July 1", "Aug 1","Sep 1","Oct 1")
    )) 
```

#What if we want to visualize cumulative growth instead of growth for each year?





```{r}
#The function phase_stats() will compute rates of expansion(growth) and shrinkage (twd) and aggregate these on a daily basis. 
#More info: ?phase_stats

DT311_phase <- phase_stats(DT311_L2, plot_phase = TRUE, plot_export = TRUE, agg_daily = TRUE, tz = 'GMT' )

#These growth and shrink rates can be compared with temperature, VPD and soil moisture.
#We will likely restrict this analysis to the growing season.
#some preliminary analysis/exploration using this

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=doy))+ geom_point(aes(y = shrink_amp, colour = "Shrinkage" ))+ geom_point(aes(y = exp_amp, colour ="Expansion"))+ ylab("Amplitude")

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=doy))+ geom_point(aes(y = shrink_slope, colour = "Shrinkage" ))+ geom_point(aes(y = exp_slope, colour ="Expansion"))+ ylab("Slope")

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=shrink_amp, y = exp_amp))+ geom_point()+ ylab(" Expansion amplitude")+ xlab(" Shrinkage amplitude")

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=shrink_slope, y = exp_slope))+ geom_point()+ ylab(" Expansion slope")+ xlab(" Shrinkage slope")
```

## Step 6: Export

Now that data is cleaned, we can export for analysis with weather data.

```{r}
#for plotting 
write.csv(file = "TOMST311_cleaned.csv", DT311_L2)
write.csv(file = "TOMST646_cleaned.csv", DT646_L2)
write.csv(file = "TOMST655_cleaned.csv", DT655_L2)

#daily growth stats 
#write.csv(file = "dendro_310BAIfull_phase_stats.csv", DT311_phase)
```

## Step 7: Seeing the difference

Now that data is cleaned, we can see how a trace diagram looks again.
Again remember that 6 plots are missing here for now.

```{r}
CEN5180_L2$yr<-CEN5180ts$yr
ggplot(CEN5180_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN5180 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


CEN8642_L2$yr<-CEN8642ts$yr
ggplot(CEN8642_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN8642 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


DT311_L2$yr<-DT311ts$yr
ggplot(DT311_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT311 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


DT646_L2$yr<-DT646ts$yr
ggplot(DT646_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT646 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


DT655_L2$yr<-DT655ts$yr
ggplot(DT655_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT655 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQRIP112_L2$yr<-HQRIP112ts$yr
ggplot(HQRIP112_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP112 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQRIP113_L2$yr<-HQRIP113ts$yr
ggplot(HQRIP113_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP113 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(HQRIP116ts_L2,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="HQRIP116 Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


HQSWP118_L2$yr<-HQSWP118ts$yr
ggplot(HQSWP118_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP118 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQSWP119_L2$yr<-HQSWP119ts$yr
ggplot(HQSWP119_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP119 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(HQSWP121ts_L2,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="HQSWP121 Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


HQSWP122_L2$yr<-HQSWP122ts$yr
ggplot(HQSWP122_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP122 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQSWP2577_L2$yr<-HQSWP2577ts$yr
ggplot(HQSWP2577_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP2577 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC07_5231_L2$yr<-PC07_5231ts$yr
ggplot(PC07_5231_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5231 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC07_5445_L2$yr<-PC07_5445ts$yr
ggplot(PC07_5445_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5445 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC09_3936_L2$yr<-PC09_3936ts$yr
ggplot(PC09_3936_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_3936 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC09_4502_L2$yr<-PC09_4502ts$yr
ggplot(PC09_4502_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_4502 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


RS20LWS_base__L2$yr<-RS20LWS_base_ts$yr
ggplot(RS20LWS_base__L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_base Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(RS20LWS_branch_ts,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="RS20LWS_branch Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


#ggplot(RS20LWS_midcanopy_ts,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="RS20LWS_midcanopy Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


RS20TSHE_5523_L2$yr<-RS20TSHE_5523ts$yr
ggplot(RS20TSHE_5523_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_5523 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


RS20TSHE_624_L2$yr<-RS20TSHE_624ts$yr
ggplot(RS20TSHE_624_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_624 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()

#ggplot(RS20TSHE_625ts,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="RS20TSHE_625 Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


UPLO_660_L2$yr<-UPLO_660ts$yr
ggplot(UPLO_660_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_660 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_662_L2$yr<-UPLO_662ts$yr
ggplot(UPLO_662_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_662 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_664_L2$yr<-UPLO_664ts$yr
ggplot(UPLO_664_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_664 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_665_L2$yr<-UPLO_665ts$yr
ggplot(UPLO_665_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_665 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_7297_L2$yr<-UPLO_7297ts$yr
ggplot(UPLO_7297_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_7297 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_abbr7297_L2$yr<-UPLO_abbr7297ts$yr
ggplot(UPLO_abbr7297_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_abbr7297 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


VAN_621_L2$yr<-VAN_621ts$yr
ggplot(VAN_621_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_621 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


VAN_abbr621_L2$yr<-VAN_abbr621ts$yr
ggplot(VAN_abbr621_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_abbr621 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(VAN_622ts,aes(x=ts,y=value,color=yr))+
# geom_point(na.rm=TRUE)+
#  labs(title="RS20TSHE_622 Stem Diameter Changes",x="Date",y="Stem Diameter Change
# (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()

```
Doing this in base R
```{r}
#First grab years string
years <-left(DT311full_cleaned_L0[,"ts"],4)
#To plot, set number of plots with par()
par(mfrow=c(1,1))
#Then set margins 
par(mar = c(5, 5, 5, 5))

for(y in 1:length(unique(years))){
#Now we can select years
sel<-DT311full_cleaned_L0[which(years==unique(years)[y]),]
#But we need to handle first year first
if(y==1){
   plot(difftime(as.POSIXct(sel$ts,format="%Y-%m-%d %H:%M:%S",tz="GMT"),
  as.POSIXct(paste0(unique(years)[y],"-01-01 00:00:00"),
                  format="%Y-%m-%d %H:%M:%S",tz="GMT"),
                  units = "days"),
         sel$gro_yr,
         ylab="Dendrometer reading (microns)",
         xlab="Day of year",type="l",
         col=rainbow(length(unique(years)))[y],pch=16,
         xlim=c(90,365),
         ylim=c(min(DT311full_cleaned_L0$gro_yr,na.rm=T),
                max(DT311full_cleaned_L0$gro_yr,na.rm=T)),
         main="310 BAI Cleaned")
    
    legend("topleft",
           as.character(unique(DT311full_cleaned_L0$yr)),
           col=rainbow(length(unique(DT311full_cleaned_L0$yr))),
           bty="n",pch=16)
# Now we can add other years
  }else{
    lines(difftime(as.POSIXct(sel$ts,format="%Y-%m-%d %H:%M:%S",tz="GMT"),
                   as.POSIXct(paste0(unique(years)[y],"-01-01 00:00:00"),
                              format="%Y-%m-%d %H:%M:%S",tz="GMT"),
                   units = "days"),
          sel$gro_yr,
          col=rainbow(length(unique(years)))[y],pch=16)}
}
```