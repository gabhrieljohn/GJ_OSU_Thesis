---
title: "TOMST Work"
author: "Gabby John"
date: "`r Sys.Date()`"
output: html_document
---


```{r setup, include=FALSE}
#Load DPLYR package
library(dplyr)
library(treenetproc, `force = TRUE`)
library(ggplot2)
library(lubridate)

left <- function(string, char){substr(string, 1,char)} 
right <- function (string, char){substr(string,nchar(string)-(char-1),nchar(string))}
```


histogram of ZO so we can see when in the year the stressors happen re:early vs late season stress to growth 

## Step 1: read in dendrometer data and get formats right
While we're here, let's also add a column for years so we can plot in ggplot instead of base R

R will not open your CSV file if its title starts with a number and will instead give an error message. You can change the title so it starts with a letter character instead. 
Make sure that the NA strings reader matches the NA codes in the original CSV file.

```{r}
#Loading in the 32 TOMST datasets with timestamps and micrometers 

CEN5180ts<- read.csv("~/research/TOMST/CEN_5180_ts_DMY.csv",stringsAsFactors = TRUE)
CEN5180ts$value<-as.numeric(CEN5180ts$value)
CEN5180ts$ts<-parse_date_time(CEN5180ts$ts,orders=c("dmy","dmy HMS"))
CEN5180ts$yr<-format(CEN5180ts$ts, "%Y")
CEN5180ts$yr<-as.factor(CEN5180ts$yr)


CEN8642ts<- read.csv("~/research/TOMST/CEN_8642_ts_DMY.csv",stringsAsFactors = TRUE)
CEN8642ts$value<-as.numeric(CEN8642ts$value)
CEN8642ts$ts<-parse_date_time(CEN8642ts$ts,orders=c("dmy","dmy HMS"))
CEN8642ts$ts <- as.POSIXct(CEN8642ts$ts,format="%d.%m.%Y %H:%M",tz="GMT") 
CEN8642ts$yr<-format(CEN8642ts$ts, "%Y")
CEN8642ts$yr<-as.factor(CEN8642ts$yr)


DT311ts <- read.csv("~/research/TOMST/DT311ts.csv", stringsAsFactors=TRUE)
DT311ts$ts<-DT311ts$datetime
DT311ts$value<-as.numeric(DT311ts$value)
DT311ts$ts<-as.POSIXct(DT311ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT311ts$ts<-parse_date_time(DT311ts$ts,orders=c("ymd","ymd HMS"))
DT311ts$yr<-format(DT311ts$ts, "%Y")
DT311ts$yr<-as.factor(DT311ts$yr)


DT646ts <- read.csv("~/research/TOMST/DT646ts.csv", stringsAsFactors=TRUE)
DT646ts$ts<-DT646ts$datetime
DT646ts$value<-as.numeric(DT646ts$value)
DT646ts$ts<-as.POSIXct(DT646ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT646ts$ts<-parse_date_time(DT646ts$ts,orders=c("ymd","ymd HMS"))
DT646ts$yr<-format(DT646ts$ts, "%Y")
DT646ts$yr<-as.factor(DT646ts$yr)



DT655ts <- read.csv("~/research/TOMST/DT655ts.csv", stringsAsFactors=TRUE)
DT655ts$ts<-DT655ts$datetime
DT655ts$value<-as.numeric(DT655ts$value)
DT655ts$ts<-as.POSIXct(DT655ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT655ts$ts<-parse_date_time(DT655ts$ts,orders=c("ymd","ymd HMS"))
DT655ts$yr<-format(DT655ts$ts, "%Y")
DT655ts$yr<-as.factor(DT655ts$yr)


HQRIP112ts<- read.csv("~/research/TOMST/HQRIP_112_ts_YMD.csv", stringsAsFactors = TRUE)
HQRIP112ts$value<-as.numeric(HQRIP112ts$value)
HQRIP112ts$ts<-as.POSIXct(HQRIP112ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP112ts$ts<-parse_date_time(HQRIP112ts$ts,orders=c("ymd","ymd HMS"))
HQRIP112ts$yr<-format(HQRIP112ts$ts, "%Y")
HQRIP112ts$yr<-as.factor(HQRIP112ts$yr)


HQRIP113ts<- read.csv("~/research/TOMST/HQRIP_113_ts_YMD.csv",stringsAsFactors = TRUE)
HQRIP113ts$value<-as.numeric(HQRIP113ts$value)
HQRIP113ts$ts<-as.POSIXct(HQRIP113ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP113ts$ts<-parse_date_time(HQRIP113ts$ts,orders=c("ymd","ymd HMS"))
HQRIP113ts$yr<-format(HQRIP113ts$ts, "%Y")
HQRIP113ts$yr<-as.factor(HQRIP113ts$yr)



HQRIP116ts<- read.csv("~/research/TOMST/HQRIP_116_ts_YMD.csv",stringsAsFactors = TRUE)
HQRIP116ts$value<-as.numeric(HQRIP116ts$value)
HQRIP116ts$ts<-as.POSIXct(HQRIP116ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP116ts$ts<-parse_date_time(HQRIP116ts$ts,orders=c("ymd","ymd HMS"))
HQRIP116ts$yr<-format(HQRIP116ts$ts, "%Y")
HQRIP116ts$yr<-as.factor(HQRIP116ts$yr)



HQSWP118ts<- read.csv("~/research/TOMST/HQSWP_118_ts_YMD.csv", stringsAsFactors = TRUE)
HQSWP118ts$value<-as.numeric(HQSWP118ts$value)
HQSWP118ts$ts<-as.POSIXct(HQSWP118ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP118ts$ts<-parse_date_time(HQSWP118ts$ts,orders=c("ymd","ymd HMS"))
HQSWP118ts$yr<-format(HQSWP118ts$ts, "%Y")
HQSWP118ts$yr<-as.factor(HQSWP118ts$yr)



HQSWP119ts<- read.csv("~/research/TOMST/HQSWP_119_ts_YMD.csv", stringsAsFactors = TRUE)
HQSWP119ts$value<-as.numeric(HQSWP119ts$value)
HQSWP119ts$ts<-as.POSIXct(HQSWP119ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP119ts$ts<-parse_date_time(HQSWP119ts$ts,orders=c("ymd","ymd HMS"))
HQSWP119ts$yr<-format(HQSWP119ts$ts, "%Y")
HQSWP119ts$yr<-as.factor(HQSWP119ts$yr)

```

```{r}

HQSWP121ts<- read.csv("~/research/TOMST/HQSWP_121_ts_formatted_badtemp.csv",stringsAsFactors = TRUE)
HQSWP121ts$value<-as.numeric(HQSWP121ts$value)
HQSWP121ts$ts<-as.POSIXct(HQSWP121ts$ts,format="%Y-%m-%d %H:%M",tz="GMT")
HQSWP121ts$ts<-parse_date_time(HQSWP121ts$ts,orders=c("ymd","ymd HMS"))
HQSWP121ts$yr<-format(HQSWP121ts$ts, "%Y")
HQSWP121ts$yr<-as.factor(HQSWP121ts$yr)



HQSWP122ts<- read.csv("~/research/TOMST/HQSWP_122_ts_YMD.csv",stringsAsFactors = TRUE)
HQSWP122ts$value<-as.numeric(HQSWP122ts$value)
HQSWP122ts$ts<-as.POSIXct(HQSWP122ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP122ts$ts<-parse_date_time(HQSWP122ts$ts,orders=c("ymd","ymd HMS"))
HQSWP122ts$yr<-format(HQSWP122ts$ts, "%Y")
HQSWP122ts$yr<-as.factor(HQSWP122ts$yr)



HQSWP2577ts<- read.csv("~/research/TOMST/HQSWP_2577_ts_YMD.csv", stringsAsFactors = TRUE)
HQSWP2577ts$value<-as.numeric(HQSWP2577ts$value)
HQSWP2577ts$ts<-as.POSIXct(HQSWP2577ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP2577ts$ts<-parse_date_time(HQSWP2577ts$ts,orders=c("ymd","ymd HMS"))
HQSWP2577ts$yr<-format(HQSWP2577ts$ts, "%Y")
HQSWP2577ts$yr<-as.factor(HQSWP2577ts$yr)


#The PCs get an error when trying to convert to POSIXct separately; not sure why.

PC07_5231ts<- read.csv("~/research/TOMST/PC07_5231_ts_DMY.csv", stringsAsFactors = TRUE)
PC07_5231ts$value<-as.numeric(PC07_5231ts$value)
#PC07_5231ts$ts<-as.POSIXct(PC07_5231ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5231ts$ts<-parse_date_time(PC07_5231ts$ts,orders=c("dmy","dmy HMS"))
PC07_5231ts$yr<-format(PC07_5231ts$ts, "%Y")
PC07_5231ts$yr<-as.factor(PC07_5231ts$yr)


PC07_5445ts<- read.csv("~/research/TOMST/PC07_5445_ts_DMY.csv",stringsAsFactors = TRUE)
PC07_5445ts$value<-as.numeric(PC07_5445ts$value)
#PC07_5445ts$ts<-as.POSIXct(PC07_5445ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5445ts$ts<-parse_date_time(PC07_5445ts$ts,orders=c("dmy","dmy HMS"))
PC07_5445ts$yr<-format(PC07_5445ts$ts, "%Y")
PC07_5445ts$yr<-as.factor(PC07_5445ts$yr)


PC09_3936ts<- read.csv("~/research/TOMST/PC09_3936_ts_DMY.csv",stringsAsFactors = TRUE)
PC09_3936ts$value<-as.numeric(PC09_3936ts$value)
#PC09_3936ts$ts<-as.POSIXct(PC09_3936ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_3936ts$ts<-parse_date_time(PC09_3936ts$ts,orders=c("dmy","dmy HMS"))
PC09_3936ts$yr<-format(PC09_3936ts$ts, "%Y")
PC09_3936ts$yr<-as.factor(PC09_3936ts$yr)


PC09_4502ts<- read.csv("~/research/TOMST/PC09_4502_ts_DMY.csv",stringsAsFactors = TRUE)
PC09_4502ts$value<-as.numeric(PC09_4502ts$value)
#PC09_4502ts$ts<-as.POSIXct(PC09_4502ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_4502ts$ts<-parse_date_time(PC09_4502ts$ts,orders=c("dmy","dmy HMS"))
PC09_4502ts$yr<-format(PC09_4502ts$ts, "%Y")
PC09_4502ts$yr<-as.factor(PC09_4502ts$yr)

RS20TSHE_624ts<-read.csv("~/research/TOMST/RS20_TSHE_624_ts_YMD.csv", stringsAsFactors = TRUE)
RS20TSHE_624ts$value<-as.numeric(RS20TSHE_624ts$value)
RS20TSHE_624ts$ts<-as.POSIXct(RS20TSHE_624ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_624ts$ts<-parse_date_time(RS20TSHE_624ts$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_624ts$yr<-format(RS20TSHE_624ts$ts, "%Y")
RS20TSHE_624ts$yr<-as.factor(RS20TSHE_624ts$yr)


RS20TSHE_625ts<- read.csv("~/research/TOMST/RS20_TSHE_625_ts_YMD.csv",
stringsAsFactors = TRUE)
RS20TSHE_625ts$value<-as.numeric(RS20TSHE_625ts$value)
RS20TSHE_625ts$ts<-as.POSIXct(RS20TSHE_625ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_625ts$ts<-parse_date_time(RS20TSHE_625ts$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_625ts$yr<-format(RS20TSHE_625ts$ts, "%Y")
RS20TSHE_625ts$yr<-as.factor(RS20TSHE_625ts$yr)


RS20TSHE_5523ts<- read.csv("~/research/TOMST/RS20_TSHE_5523_ts_YMD.csv",
                     stringsAsFactors = TRUE)
RS20TSHE_5523ts$value<-as.numeric(RS20TSHE_5523ts$value)
RS20TSHE_5523ts$ts<-as.POSIXct(RS20TSHE_5523ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_5523ts$ts<-parse_date_time(RS20TSHE_5523ts$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_5523ts$yr<-format(RS20TSHE_5523ts$ts, "%Y")
RS20TSHE_5523ts$yr<-as.factor(RS20TSHE_5523ts$yr)


RS20LWS_base_ts<- read.csv("~/research/TOMST/RS20LWS_base_ts_YMD.csv",
                     stringsAsFactors = TRUE)
RS20LWS_base_ts$value<-as.numeric(RS20LWS_base_ts$value)
RS20LWS_base_ts$ts<-as.POSIXct(RS20LWS_base_ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_base_ts$ts<-parse_date_time(RS20LWS_base_ts$ts,orders=c("ymd","ymd HMS"))
RS20LWS_base_ts$yr<-format(RS20LWS_base_ts$ts, "%Y")
RS20LWS_base_ts$yr<-as.factor(RS20LWS_base_ts$yr)

RS20LWS_branch_ts<- read.csv("~/research/TOMST/RS20LWS_branch_ts_YMD.csv",
                     stringsAsFactors = TRUE)
RS20LWS_branch_ts$value<-as.numeric(RS20LWS_branch_ts$value)
RS20LWS_branch_ts$ts<-as.POSIXct(RS20LWS_branch_ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_branch_ts$ts<-parse_date_time(RS20LWS_branch_ts$ts,orders=c("ymd","ymd HMS"))
RS20LWS_branch_ts$yr<-format(RS20LWS_branch_ts$ts, "%Y")
RS20LWS_branch_ts$yr<-as.factor(RS20LWS_branch_ts$yr)

RS20LWS_midcanopy_ts<-read.csv("~/research/TOMST/RS20LWS_midcanopy_ts_YMD.csv",stringsAsFactors = TRUE)
RS20LWS_midcanopy_ts$value<-as.numeric(RS20LWS_midcanopy_ts$value)
RS20LWS_midcanopy_ts$ts<-as.POSIXct(RS20LWS_midcanopy_ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_midcanopy_ts$ts<-parse_date_time(RS20LWS_midcanopy_ts$ts,orders=c("ymd","ymd HMS"))
RS20LWS_midcanopy_ts$yr<-format(RS20LWS_midcanopy_ts$ts, "%Y")
RS20LWS_midcanopy_ts$yr<-as.factor(RS20LWS_midcanopy_ts$yr)


UPLO_660ts<- read.csv("~/research/TOMST/UPLO_660_ts_YMD.csv",stringsAsFactors = TRUE)
UPLO_660ts$value<-as.numeric(UPLO_660ts$value)
UPLO_660ts$ts<-as.POSIXct(UPLO_660ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_660ts$ts<-parse_date_time(UPLO_660ts$ts,orders=c("ymd","ymd HMS"))
UPLO_660ts$yr<-format(UPLO_660ts$ts, "%Y")
UPLO_660ts$yr<-as.factor(UPLO_660ts$yr)


UPLO_662ts<- read.csv("~/research/TOMST/UPLO_662_ts_YMD.csv",stringsAsFactors = TRUE)
UPLO_662ts$value<-as.numeric(UPLO_662ts$value)
UPLO_662ts$ts<-as.POSIXct(UPLO_662ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_662ts$ts<-parse_date_time(UPLO_662ts$ts,orders=c("ymd","ymd HMS"))
UPLO_662ts$yr<-format(UPLO_662ts$ts, "%Y")
UPLO_662ts$yr<-as.factor(UPLO_662ts$yr)


UPLO_664ts<- read.csv("~/research/TOMST/UPLO_664_ts_YMD.csv", stringsAsFactors = TRUE)
UPLO_664ts$value<-as.numeric(UPLO_664ts$value)
UPLO_664ts$ts<-as.POSIXct(UPLO_664ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_664ts$ts<-parse_date_time(UPLO_664ts$ts,orders=c("ymd","ymd HMS"))
UPLO_664ts$yr<-format(UPLO_664ts$ts, "%Y")
UPLO_664ts$yr<-as.factor(UPLO_664ts$yr)


UPLO_665ts<- read.csv("~/research/TOMST/UPLO_665_ts_YMD.csv",stringsAsFactors = TRUE)
UPLO_665ts$value<-as.numeric(UPLO_665ts$value)
UPLO_665ts$ts<-as.POSIXct(UPLO_665ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_665ts$ts<-parse_date_time(UPLO_665ts$ts,orders=c("ymd","ymd HMS"))
UPLO_665ts$yr<-format(UPLO_665ts$ts, "%Y")
UPLO_665ts$yr<-as.factor(UPLO_665ts$yr)


UPLO_abbr7297ts<- read.csv("~/research/TOMST/UPLO_7297_abbr_ts_YMD.csv",
                     stringsAsFactors = TRUE)
UPLO_abbr7297ts$value<-as.numeric(UPLO_abbr7297ts$value)
UPLO_abbr7297ts$ts<-as.POSIXct(UPLO_abbr7297ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_abbr7297ts$ts<-parse_date_time(UPLO_abbr7297ts$ts,orders=c("ymd","ymd HMS"))
UPLO_abbr7297ts$yr<-format(UPLO_abbr7297ts$ts, "%Y")
UPLO_abbr7297ts$yr<-as.factor(UPLO_abbr7297ts$yr)


UPLO_7297ts<- read.csv("~/research/TOMST/UPLO_7297_ts_YMD.csv",
                     stringsAsFactors = TRUE)
UPLO_7297ts$value<-as.numeric(UPLO_7297ts$value)
UPLO_7297ts$ts<-as.POSIXct(UPLO_7297ts$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_7297ts$ts<-parse_date_time(UPLO_7297ts$ts,orders=c("ymd","ymd HMS"))
UPLO_7297ts$yr<-format(UPLO_7297ts$ts, "%Y")
UPLO_7297ts$yr<-as.factor(UPLO_7297ts$yr)


VAN_abbr621ts<- read.csv("~/research/TOMST/VAN_621_abbr_ts_DMY.csv",
                     stringsAsFactors = TRUE)
VAN_abbr621ts$value<-as.numeric(VAN_abbr621ts$value)
#VAN_abbr621ts$ts<-as.POSIXct(VAN_abbr621ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_abbr621ts$ts<-parse_date_time(VAN_abbr621ts$ts,orders=c("dmy","dmy HMS"))
VAN_abbr621ts$yr<-format(VAN_abbr621ts$ts, "%Y")
VAN_abbr621ts$yr<-as.factor(VAN_abbr621ts$yr)


VAN_621ts<- read.csv("~/research/TOMST/VAN_621_ts_DMY.csv",
                     stringsAsFactors = TRUE)
VAN_621ts$value<-as.numeric(VAN_621ts$value)
#VAN_621ts$ts<-as.POSIXct(VAN_621ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_621ts$ts<-parse_date_time(VAN_621ts$ts,orders=c("dmy","dmy HMS"))
VAN_621ts$yr<-format(VAN_621ts$ts, "%Y")
VAN_621ts$yr<-as.factor(VAN_621ts$yr)


VAN_622ts<- read.csv("~/research/TOMST/VAN_622_ts_DMY.csv",
                     stringsAsFactors = TRUE)
VAN_622ts$value<-as.numeric(VAN_622ts$value)
#VAN_622ts$ts<-as.POSIXct(VAN_abbr622ts$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_622ts$ts<-parse_date_time(VAN_622ts$ts,orders=c("dmy","dmy HMS"))
VAN_622ts$yr<-format(VAN_622ts$ts, "%Y")
VAN_622ts$yr<-as.factor(VAN_622ts$yr)
```


##Step 2: Getting initial raw plots
```{r}
ggplot(CEN5180ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN5180 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()

ggplot(CEN8642ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN8642 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(DT311ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT311 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(DT646ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT646 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(DT655ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT655 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQRIP112ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP112 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQRIP113ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP113 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQRIP116ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP116 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP118ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP118 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP119ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP119 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP121ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP121 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP122ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP122 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(HQSWP2577ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP2577 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC07_5231ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5231 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC07_5445ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5445 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC09_3936ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_3936 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(PC09_4502ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_4502 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20LWS_base_ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_base Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20LWS_branch_ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_branch Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20LWS_midcanopy_ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_midcanopy Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20TSHE_5523ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_5523 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(RS20TSHE_624ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_624 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()

ggplot(RS20TSHE_625ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_625 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_660ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_660 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_662ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_662 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_664ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_664 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_665ts,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_665 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_7297ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_7297 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(UPLO_abbr7297ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_abbr7297 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(VAN_621ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_621 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(VAN_abbr621ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_abbr621 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


ggplot(VAN_622ts,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_622 Stem Diameter Changes",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()
```




##Step 3: Reading in and formatting temperature data 

```{r}
CEN5180temp<- read.csv("~/research/TOMST/CEN_5180_temp.csv",stringsAsFactors = TRUE)
CEN5180temp$value<-as.numeric(CEN5180temp$value)
CEN5180temp$ts<-parse_date_time(CEN5180temp$ts,orders=c("dmy","dmy HMS"))
CEN5180temp$yr<-format(CEN5180temp$ts, "%Y")
CEN5180temp$yr<-as.factor(CEN5180temp$yr)
write.csv(file="CEN5180temp.csv",CEN5180temp)


CEN8642temp<- read.csv("~/research/TOMST/CEN_8642_temp.csv",stringsAsFactors = TRUE)
CEN8642temp$value<-as.numeric(CEN8642temp$value)
CEN8642temp$ts<-parse_date_time(CEN8642temp$ts,orders=c("dmy","dmy HMS"))
CEN8642temp$yr<-as.factor(format(CEN8642temp$ts, "%Y"))


DT311temp <- read.csv("~/research/TOMST/DT311temp.csv", stringsAsFactors=TRUE)
DT311temp$ts<-DT311temp$datetime
DT311temp$value<-as.numeric(DT311temp$temp)
DT311temp$ts <- as.POSIXct(DT311temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT311temp$ts<-parse_date_time(DT311temp$ts,orders=c("ymd","ymd HMS"))
DT311temp$yr<-format(DT311temp$ts, "%Y")
DT311temp$yr<-as.factor(DT311temp$yr)


DT646temp <- read.csv("~/research/TOMST/DT646temp.csv", stringsAsFactors=TRUE)
DT646temp$ts<-DT646temp$datetime
DT646temp$value<-as.numeric(DT646temp$temp)
DT646temp$ts <- as.POSIXct(DT646temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT646temp$ts<-parse_date_time(DT646temp$ts,orders=c("ymd","ymd HMS"))
DT646temp$yr<-format(DT646temp$ts, "%Y")
DT646temp$yr<-as.factor(DT646temp$yr)


DT655temp <- read.csv("~/research/TOMST/DT655temp.csv", stringsAsFactors=TRUE)
DT655temp$ts<-DT655temp$datetime
DT655temp$value<-as.numeric(DT655temp$temp)
DT655temp$ts <- as.POSIXct(DT655temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
DT655temp$ts<-parse_date_time(DT655temp$ts,orders=c("ymd","ymd HMS"))
DT655temp$yr<-format(DT655temp$ts, "%Y")
DT655temp$yr<-as.factor(DT655temp$yr)


HQRIP112temp<- read.csv("~/research/TOMST/HQRIP_112_temp.csv", stringsAsFactors = TRUE)
HQRIP112temp$value<-as.numeric(HQRIP112temp$value)
HQRIP112temp$ts <- as.POSIXct(HQRIP112temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP112temp$ts<-parse_date_time(HQRIP112temp$ts,orders=c("ymd","ymd HMS"))
HQRIP112temp$yr<-format(HQRIP112temp$ts, "%Y")
HQRIP112temp$yr<-as.factor(HQRIP112temp$yr)


HQRIP113temp<- read.csv("~/research/TOMST/HQRIP_113_temp.csv",stringsAsFactors = TRUE)
HQRIP113temp$value<-as.numeric(HQRIP113temp$value)
HQRIP113temp$ts <- as.POSIXct(HQRIP113temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP113temp$ts<-parse_date_time(HQRIP113temp$ts,orders=c("ymd","ymd HMS"))
HQRIP113temp$yr<-format(HQRIP113temp$ts, "%Y")
HQRIP113temp$yr<-as.factor(HQRIP113temp$yr)


HQRIP116temp<- read.csv("~/research/TOMST/HQRIP_116_temp.csv",stringsAsFactors = TRUE)
HQRIP116temp$value<-as.numeric(HQRIP116temp$value)
HQRIP116temp$ts <- as.POSIXct(HQRIP116temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQRIP116temp$ts<-parse_date_time(HQRIP116temp$ts,orders=c("ymd","ymd HMS"))
HQRIP116temp$yr<-format(HQRIP116temp$ts, "%Y")
HQRIP116temp$yr<-as.factor(HQRIP116temp$yr)


HQSWP118temp<- read.csv("~/research/TOMST/HQSWP_118_temp.csv", stringsAsFactors = TRUE)
HQSWP118temp$value<-as.numeric(HQSWP118temp$value)
HQSWP118temp$ts <- as.POSIXct(HQSWP118temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP118temp$ts<-parse_date_time(HQSWP118temp$ts,orders=c("ymd","ymd HMS"))
HQSWP118temp$yr<-format(HQSWP118temp$ts, "%Y")
HQSWP118temp$yr<-as.factor(HQSWP118temp$yr)


HQSWP119temp<- read.csv("~/research/TOMST/HQSWP_119_temp.csv", stringsAsFactors = TRUE)
HQSWP119temp$value<-as.numeric(HQSWP119temp$value)
HQSWP119temp$ts <- as.POSIXct(HQSWP119temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP119temp$ts<-parse_date_time(HQSWP119temp$ts,orders=c("ymd","ymd HMS"))
HQSWP119temp$yr<-format(HQSWP119temp$ts, "%Y")
HQSWP119temp$yr<-as.factor(HQSWP119temp$yr)


HQSWP122temp<- read.csv("~/research/TOMST/HQSWP_122_temp.csv",stringsAsFactors = TRUE)
HQSWP122temp$value<-as.numeric(HQSWP122temp$value)
HQSWP122temp$ts <- as.POSIXct(HQSWP122temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP122temp$ts<-parse_date_time(HQSWP122temp$ts,orders=c("ymd","ymd HMS"))
HQSWP122temp$yr<-format(HQSWP122temp$ts, "%Y")
HQSWP122temp$yr<-as.factor(HQSWP122temp$yr)


HQSWP2577temp<- read.csv("~/research/TOMST/HQSWP_2577_temp.csv", stringsAsFactors = TRUE)
HQSWP2577temp$value<-as.numeric(HQSWP2577temp$value)
HQSWP2577temp$ts <- as.POSIXct(HQSWP2577temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
HQSWP2577temp$ts<-parse_date_time(HQSWP2577temp$ts,orders=c("ymd","ymd HMS"))
HQSWP2577temp$yr<-format(HQSWP2577temp$ts, "%Y")
HQSWP2577temp$yr<-as.factor(HQSWP2577temp$yr)


PC07_5231temp<- read.csv("~/research/TOMST/PC07_5231_temp.csv", stringsAsFactors = TRUE)
PC07_5231temp$value<-as.numeric(PC07_5231temp$value)
#PC07_5231temp$ts <- as.POSIXct(PC07_5231temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5231temp$ts<-parse_date_time(PC07_5231temp$ts,orders=c("dmy","dmy HMS"))
PC07_5231temp$yr<-format(PC07_5231temp$ts, "%Y")
PC07_5231temp$yr<-as.factor(PC07_5231temp$yr)


PC07_5445temp<- read.csv("~/research/TOMST/PC07_5445_temp.csv",stringsAsFactors = TRUE)
PC07_5445temp$value<-as.numeric(PC07_5445temp$value)
#PC07_5445temp$ts <- as.POSIXct(PC07_5445temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC07_5445temp$ts<-parse_date_time(PC07_5445temp$ts,orders=c("dmy","dmy HMS"))
PC07_5445temp$yr<-format(PC07_5445temp$ts, "%Y")
PC07_5445temp$yr<-as.factor(PC07_5445temp$yr)


PC09_3936temp<- read.csv("~/research/TOMST/PC09_3936_temp.csv",stringsAsFactors = TRUE)
PC09_3936temp$value<-as.numeric(PC09_3936temp$value)
#PC09_3936temp$ts <- as.POSIXct(PC09_3936temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_3936temp$ts<-parse_date_time(PC09_3936temp$ts,orders=c("dmy","dmy HMS"))
PC09_3936temp$yr<-format(PC09_3936temp$ts, "%Y")
PC09_3936temp$yr<-as.factor(PC09_3936temp$yr)


PC09_4502temp<- read.csv("~/research/TOMST/PC09_4502_temp.csv",stringsAsFactors = TRUE)
PC09_4502temp$value<-as.numeric(PC09_4502temp$value)
#PC09_4502temp$ts <- as.POSIXct(PC09_4502temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
PC09_4502temp$ts<-parse_date_time(PC09_4502temp$ts,orders=c("dmy","dmy HMS"))
PC09_4502temp$yr<-format(PC09_4502temp$ts, "%Y")
PC09_4502temp$yr<-as.factor(PC09_4502temp$yr)


RS20TSHE_624temp<-read.csv("~/research/TOMST/RS20_TSHE_624_temp.csv", stringsAsFactors = TRUE)
RS20TSHE_624temp$value<-as.numeric(RS20TSHE_624temp$value)
RS20TSHE_624temp$ts <- as.POSIXct(RS20TSHE_624temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_624temp$ts<-parse_date_time(RS20TSHE_624temp$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_624temp$yr<-format(RS20TSHE_624temp$ts, "%Y")
RS20TSHE_624temp$yr<-as.factor(RS20TSHE_624temp$yr)


RS20TSHE_625temp<- read.csv("~/research/TOMST/RS20_TSHE_625_temp.csv",
stringsAsFactors = TRUE)
RS20TSHE_625temp$value<-as.numeric(RS20TSHE_625temp$value)
RS20TSHE_625temp$ts <- as.POSIXct(RS20TSHE_625temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_625temp$ts<-parse_date_time(RS20TSHE_625temp$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_625temp$yr<-format(RS20TSHE_625temp$ts, "%Y")
RS20TSHE_625temp$yr<-as.factor(RS20TSHE_625temp$yr)


RS20TSHE_5523temp<- read.csv("~/research/TOMST/RS20_TSHE_5523_temp.csv",
                     stringsAsFactors = TRUE)
RS20TSHE_5523temp$value<-as.numeric(RS20TSHE_5523temp$value)
RS20TSHE_5523temp$ts <- as.POSIXct(RS20TSHE_5523temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20TSHE_5523temp$ts<-parse_date_time(RS20TSHE_5523temp$ts,orders=c("ymd","ymd HMS"))
RS20TSHE_5523temp$yr<-format(RS20TSHE_5523temp$ts, "%Y")
RS20TSHE_5523temp$yr<-as.factor(RS20TSHE_5523temp$yr)


RS20LWS_base_temp<- read.csv("~/research/TOMST/RS20LWS_base_temp.csv",
                     stringsAsFactors = TRUE)
RS20LWS_base_temp$value<-as.numeric(RS20LWS_base_temp$value)
RS20LWS_base_temp$ts <- as.POSIXct(RS20LWS_base_temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_base_temp$ts<-parse_date_time(RS20LWS_base_temp$ts,orders=c("ymd","ymd HMS"))
RS20LWS_base_temp$yr<-format(RS20LWS_base_temp$ts, "%Y")
RS20LWS_base_temp$yr<-as.factor(RS20LWS_base_temp$yr)


RS20LWS_branch_temp<- read.csv("~/research/TOMST/RS20LWS_branch_temp.csv",
                     stringsAsFactors = TRUE)
RS20LWS_branch_temp$value<-as.numeric(RS20LWS_branch_temp$value)
RS20LWS_branch_temp$ts <- as.POSIXct(RS20LWS_branch_temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_branch_temp$ts<-parse_date_time(RS20LWS_branch_temp$ts,orders=c("ymd","ymd HMS"))
RS20LWS_branch_temp$yr<-format(RS20LWS_branch_temp$ts, "%Y")
RS20LWS_branch_temp$yr<-as.factor(RS20LWS_branch_temp$yr)


RS20LWS_midcanopy_temp<-read.csv("~/research/TOMST/RS20LWS_midcanopy_temp.csv",stringsAsFactors = TRUE)
RS20LWS_midcanopy_temp$value<-as.numeric(RS20LWS_midcanopy_temp$value)
RS20LWS_midcanopy_temp$ts <- as.POSIXct(RS20LWS_midcanopy_temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
RS20LWS_midcanopy_temp$ts<-parse_date_time(RS20LWS_midcanopy_temp$ts,orders=c("ymd","ymd HMS"))
RS20LWS_midcanopy_temp$yr<-format(RS20LWS_midcanopy_temp$ts, "%Y")
RS20LWS_midcanopy_temp$yr<-as.factor(RS20LWS_midcanopy_temp$yr)


UPLO_660temp<- read.csv("~/research/TOMST/UPLO_660_temp.csv",stringsAsFactors = TRUE)
UPLO_660temp$value<-as.numeric(UPLO_660temp$value)
UPLO_660temp$ts <- as.POSIXct(UPLO_660temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_660temp$ts<-parse_date_time(UPLO_660temp$ts,orders=c("ymd","ymd HMS"))
UPLO_660temp$yr<-format(UPLO_660temp$ts, "%Y")
UPLO_660temp$yr<-as.factor(UPLO_660temp$yr)


UPLO_662temp<- read.csv("~/research/TOMST/UPLO_662_temp.csv",stringsAsFactors = TRUE)
UPLO_662temp$value<-as.numeric(UPLO_662temp$value)
UPLO_662temp$ts <- as.POSIXct(UPLO_662temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_662temp$ts<-parse_date_time(UPLO_662temp$ts,orders=c("ymd","ymd HMS"))
UPLO_662temp$yr<-format(UPLO_662temp$ts, "%Y")
UPLO_662temp$yr<-as.factor(UPLO_662temp$yr)


UPLO_664temp<- read.csv("~/research/TOMST/UPLO_664_temp.csv", stringsAsFactors = TRUE)
UPLO_664temp$value<-as.numeric(UPLO_664temp$value)
UPLO_664temp$ts <- as.POSIXct(UPLO_664temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_664temp$ts<-parse_date_time(UPLO_664temp$ts,orders=c("ymd","ymd HMS"))
UPLO_664temp$yr<-format(UPLO_664temp$ts, "%Y")
UPLO_664temp$yr<-as.factor(UPLO_664temp$yr)


UPLO_665temp<- read.csv("~/research/TOMST/UPLO_665_temp.csv",stringsAsFactors = TRUE)
UPLO_665temp$value<-as.numeric(UPLO_665temp$value)
UPLO_665temp$ts <- as.POSIXct(UPLO_665temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_665temp$ts<-parse_date_time(UPLO_665temp$ts,orders=c("ymd","ymd HMS"))
UPLO_665temp$yr<-format(UPLO_665temp$ts, "%Y")
UPLO_665temp$yr<-as.factor(UPLO_665temp$yr)


UPLO_abbr7297temp<- read.csv("~/research/TOMST/UPLO_7297_abbr_temp.csv",
                     stringsAsFactors = TRUE)
UPLO_abbr7297temp$value<-as.numeric(UPLO_abbr7297temp$value)
UPLO_abbr7297temp$ts <- as.POSIXct(UPLO_abbr7297temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_abbr7297temp$ts<-parse_date_time(UPLO_abbr7297temp$ts,orders=c("ymd","ymd HMS"))
UPLO_abbr7297temp$yr<-format(UPLO_abbr7297temp$ts, "%Y")
UPLO_abbr7297temp$yr<-as.factor(UPLO_abbr7297temp$yr)


UPLO_7297temp<- read.csv("~/research/TOMST/UPLO_7297_temp.csv",
                     stringsAsFactors = TRUE)
UPLO_7297temp$value<-as.numeric(UPLO_7297temp$value)
UPLO_7297temp$ts <- as.POSIXct(UPLO_7297temp$ts,format="%Y.%m.%d %H:%M",tz="GMT")
UPLO_7297temp$ts<-parse_date_time(UPLO_7297temp$ts,orders=c("ymd","ymd HMS"))
UPLO_7297temp$yr<-format(UPLO_7297temp$ts, "%Y")
UPLO_7297temp$yr<-as.factor(UPLO_7297temp$yr)


VAN_abbr621temp<- read.csv("~/research/TOMST/VAN_621_abbr_temp.csv",
                     stringsAsFactors = TRUE)
VAN_abbr621temp$value<-as.numeric(VAN_abbr621temp$value)
#VAN_abbr621temp$ts <- as.POSIXct(VAN_abbr621temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_abbr621temp$ts<-parse_date_time(VAN_abbr621temp$ts,orders=c("dmy","dmy HMS"))
VAN_abbr621temp$yr<-format(VAN_abbr621temp$ts, "%Y")
VAN_abbr621temp$yr<-as.factor(VAN_abbr621temp$yr)


VAN_621temp<- read.csv("~/research/TOMST/VAN_621_temp.csv",
                     stringsAsFactors = TRUE)
VAN_621temp$value<-as.numeric(VAN_621temp$value)
#VAN_621temp$ts <- as.POSIXct(VAN_621temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_621temp$ts<-parse_date_time(VAN_621temp$ts,orders=c("dmy","dmy HMS"))
VAN_621temp$yr<-format(VAN_621temp$ts, "%Y")
VAN_621temp$yr<-as.factor(VAN_621temp$yr)


VAN_622temp<- read.csv("~/research/TOMST/VAN_622_temp.csv",
                     stringsAsFactors = TRUE)
VAN_622temp$value<-as.numeric(VAN_622temp$value)
#VAN_622temp$ts <- as.POSIXct(VAN_622temp$ts,format="%d.%m.%Y %H:%M",tz="GMT")
VAN_622temp$ts<-parse_date_time(VAN_622temp$ts,orders=c("dmy","dmy HMS"))
VAN_622temp$yr<-format(VAN_622temp$temp, "%Y")
VAN_622temp$yr<-as.factor(VAN_622temp$yr)
```



##Step 4 SHOULD BE: time-align temperature data with proc_L1. Make sure the "reso" matches the time interval of the dendrometer data. 
However, in this file proc_L1 is not recognizing the defined time format. Thus, what is done below is adding columns to the dendro and temp objects so that proc_L2 thinks that L1 worked.

##Step 5: Proc_dendro_L2, which integrates L1-processed dendrometer readings with temperature, detects errors, corrects them and plots gro and twd by date.
more info here: ?treenetproc::proc_dendro_L2
Plots will be exported to working directory as pdf

Even though the formats are all the same, some (6) of the 30 dendrometers are not responding correctly to the L2 function, so those have been labeled as text not code so R will overlook it for now. This is true for:

HQRIP116
HQSWP121
RS20LWS_branch
RS20LWS_midcanopy
RS20TSHE_625
VAN_622

```{r}
CEN5180ts$series<-"CEN5180"
CEN5180temp$series<-"CEN5180"
CEN5180temp$version<-"N.A"

CEN5180_L2 <- proc_dendro_L2(dendro_L1 = CEN5180ts,temp_L1 = CEN5180temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "CEN5180", tz="GMT") 



CEN8642ts$series<-"CEN8642"
CEN8642temp$series<-"CEN8642"
CEN8642temp$version<-"N.A"

CEN8642_L2 <- proc_dendro_L2(dendro_L1 = CEN8642ts,temp_L1 = CEN8642temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "CEN8642", tz="GMT") 



DT311ts$series<-"DT311"
DT311temp$series<-"DT311"
DT311temp$version<-"N.A"

DT311_L2 <- proc_dendro_L2(dendro_L1 = DT311ts,temp_L1 = DT311temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "DT311", tz="GMT") 



DT646ts$series<-"DT646"
DT646temp$series<-"DT646"
DT646temp$version<-"N.A"

DT646_L2 <- proc_dendro_L2(dendro_L1 = DT646ts,temp_L1 = DT646temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "DT646", tz="GMT") 



DT655ts$series<-"DT655"
DT655temp$series<-"DT655"
DT655temp$version<-"N.A"

DT655_L2 <- proc_dendro_L2(dendro_L1 = DT655ts,temp_L1 = DT655temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "DT655", tz="GMT") 



HQRIP112ts$series<-"HQRIP112"
HQRIP112temp$series<-"HQRIP112"
HQRIP112temp$version<-"N.A"

HQRIP112_L2 <- proc_dendro_L2(dendro_L1 = HQRIP112ts,temp_L1 = HQRIP112temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQRIP112", tz="GMT") 



HQRIP113ts$series<-"HQRIP113"
HQRIP113temp$series<-"HQRIP113"
HQRIP113temp$version<-"N.A"

HQRIP113_L2 <- proc_dendro_L2(dendro_L1 = HQRIP113ts,temp_L1 = HQRIP113temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQRIP113", tz="GMT") 

HQRIP116ts$series<-"HQRIP116"
HQRIP116temp$series<-"HQRIP116"
HQRIP116temp$version<-"N.A"


#HQRIP116_L2 <- proc_dendro_L2(dendro_L1 = HQRIP116ts,temp_L1 = HQRIP116temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQRIP116", tz="GMT") 


HQSWP118ts$series<-"HQSWP118"
HQSWP118temp$series<-"HQSWP118"
HQSWP118temp$version<-"N.A"

HQSWP118_L2 <- proc_dendro_L2(dendro_L1 = HQSWP118ts,temp_L1 = HQSWP118temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP118", tz="GMT") 



HQSWP119ts$series<-"HQSWP119"
HQSWP119temp$series<-"HQSWP119"
HQSWP119temp$version<-"N.A"

HQSWP119_L2 <- proc_dendro_L2(dendro_L1 = HQSWP119ts,temp_L1 = HQSWP119temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP119", tz="GMT") 


HQSWP121ts$series<-"HQSWP121"
#remember that this dendrometer had bad temperature values so we will omit that from this L2 processing

#HQSWP121_L2 <- proc_dendro_L2(dendro_L1 = HQSWP121ts, temp_L1 = NULL,tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP121", tz="GMT")



HQSWP122ts$series<-"HQSWP122"
HQSWP122temp$series<-"HQSWP122"
HQSWP122temp$version<-"N.A"

HQSWP122_L2 <- proc_dendro_L2(dendro_L1 = HQSWP122ts,temp_L1 = HQSWP122temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP122", tz="GMT") 



HQSWP2577ts$series<-"HQSWP2577"
HQSWP2577temp$series<-"HQSWP2577"
HQSWP2577temp$version<-"N.A"

HQSWP2577_L2 <- proc_dendro_L2(dendro_L1 = HQSWP2577ts,temp_L1 = HQSWP2577temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "HQSWP2577", tz="GMT") 



PC07_5231ts$series<-"PC07_5231"
PC07_5231temp$series<-"PC07_5231"
PC07_5231temp$version<-"N.A"

PC07_5231_L2 <- proc_dendro_L2(dendro_L1 = PC07_5231ts,temp_L1 = PC07_5231temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC07_5231", tz="GMT") 



PC07_5445ts$series<-"PC07_5445"
PC07_5445temp$series<-"PC07_5445"
PC07_5445temp$version<-"N.A"

PC07_5445_L2 <- proc_dendro_L2(dendro_L1 = PC07_5445ts,temp_L1 = PC07_5445temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC07_5445", tz="GMT") 



PC09_3936ts$series<-"PC09_3936"
PC09_3936temp$series<-"PC09_3936"
PC09_3936temp$version<-"N.A"

PC09_3936_L2 <- proc_dendro_L2(dendro_L1 = PC09_3936ts,temp_L1 = PC09_3936temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC09_3936", tz="GMT") 



PC09_4502ts$series<-"PC09_4502"
PC09_4502temp$series<-"PC09_4502"
PC09_4502temp$version<-"N.A"

PC09_4502_L2 <- proc_dendro_L2(dendro_L1 = PC09_4502ts,temp_L1 = PC09_4502temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "PC09_4502", tz="GMT") 



RS20LWS_base_ts$series<-"RS20LWS_base_"
RS20LWS_base_temp$series<-"RS20LWS_base_"
RS20LWS_base_temp$version<-"N.A"

RS20LWS_base__L2 <- proc_dendro_L2(dendro_L1 = RS20LWS_base_ts,temp_L1 = RS20LWS_base_temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20LWS_base_", tz="GMT") 



RS20LWS_branch_ts$series<-"RS20LWS_branch"
RS20LWS_branch_temp$series<-"RS20LWS_branch"
RS20LWS_branch_temp$version<-"N.A"

#RS20LWS_branch_L2 <- proc_dendro_L2(dendro_L1 = RS20LWS_branch_ts,temp_L1 = RS20LWS_branch_temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20LWS_branch_", tz="GMT") 



RS20LWS_midcanopy_ts$series<-"RS20LWS_midcanopy_"
RS20LWS_midcanopy_temp$series<-"RS20LWS_midcanopy_"
RS20LWS_midcanopy_temp$version<-"N.A"

#RS20LWS_midcanopy_L2 <- proc_dendro_L2(dendro_L1 = RS20LWS_midcanopy_ts,temp_L1 = RS20LWS_midcanopy_temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20LWS_midcanopy_", tz="GMT") 



RS20TSHE_5523ts$series<-"RS20TSHE_5523"
RS20TSHE_5523temp$series<-"RS20TSHE_5523"
RS20TSHE_5523temp$version<-"N.A"

RS20TSHE_5523_L2 <- proc_dendro_L2(dendro_L1 = RS20TSHE_5523ts,temp_L1 = RS20TSHE_5523temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20TSHE_5523", tz="GMT") 



RS20TSHE_624ts$series<-"RS20TSHE_624"
RS20TSHE_624temp$series<-"RS20TSHE_624"
RS20TSHE_624temp$version<-"N.A"

RS20TSHE_624_L2 <- proc_dendro_L2(dendro_L1 = RS20TSHE_624ts,temp_L1 = RS20TSHE_624temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20TSHE_624", tz="GMT") 



RS20TSHE_625ts$series<-"RS20TSHE_625"
RS20TSHE_625temp$series<-"RS20TSHE_625"
RS20TSHE_625temp$version<-"N.A"

#RS20TSHE_625_L2 <- proc_dendro_L2(dendro_L1 = RS20TSHE_625ts,temp_L1 = RS20TSHE_625temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "RS20TSHE_625", tz="GMT") 



UPLO_660ts$series<-"UPLO_660"
UPLO_660temp$series<-"UPLO_660"
UPLO_660temp$version<-"N.A"

UPLO_660_L2 <- proc_dendro_L2(dendro_L1 = UPLO_660ts,temp_L1 = UPLO_660temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_660", tz="GMT") 



UPLO_662ts$series<-"UPLO_662"
UPLO_662temp$series<-"UPLO_662"
UPLO_662temp$version<-"N.A"

UPLO_662_L2 <- proc_dendro_L2(dendro_L1 = UPLO_662ts,temp_L1 = UPLO_662temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_662", tz="GMT") 



UPLO_664ts$series<-"UPLO_664"
UPLO_664temp$series<-"UPLO_664"
UPLO_664temp$version<-"N.A"

UPLO_664_L2 <- proc_dendro_L2(dendro_L1 = UPLO_664ts,temp_L1 = UPLO_664temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_664", tz="GMT") 



UPLO_665ts$series<-"UPLO_665"
UPLO_665temp$series<-"UPLO_665"
UPLO_665temp$version<-"N.A"

UPLO_665_L2 <- proc_dendro_L2(dendro_L1 = UPLO_665ts,temp_L1 = UPLO_665temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_665", tz="GMT") 



UPLO_7297ts$series<-"UPLO_7297"
UPLO_7297temp$series<-"UPLO_7297"
UPLO_7297temp$version<-"N.A"

UPLO_7297_L2 <- proc_dendro_L2(dendro_L1 = UPLO_7297ts,temp_L1 = UPLO_7297temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_7297", tz="GMT") 



UPLO_abbr7297ts$series<-"UPLO_abbr7297"
UPLO_abbr7297temp$series<-"UPLO_abbr7297"
UPLO_abbr7297temp$version<-"N.A"

UPLO_abbr7297_L2 <- proc_dendro_L2(dendro_L1 = UPLO_abbr7297ts,temp_L1 = UPLO_abbr7297temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "UPLO_abbr7297", tz="GMT") 



VAN_621ts$series<-"VAN_621"
VAN_621temp$series<-"VAN_621"
VAN_621temp$version<-"N.A"

VAN_621_L2 <- proc_dendro_L2(dendro_L1 = VAN_621ts,temp_L1 = VAN_621temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "VAN_621", tz="GMT") 



VAN_622ts$series<-"VAN_622"
VAN_622temp$series<-"VAN_622"
VAN_622temp$version<-"N.A"

#VAN_622_L2 <- proc_dendro_L2(dendro_L1 = VAN_622ts,temp_L1 = VAN_622temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "VAN_622", tz="GMT") 



VAN_abbr621ts$series<-"VAN_abbr621"
VAN_abbr621temp$series<-"VAN_abbr621"
VAN_abbr621temp$version<-"N.A"

VAN_abbr621_L2 <- proc_dendro_L2(dendro_L1 = VAN_abbr621ts,temp_L1 = VAN_abbr621temp, tol_out = 2, tol_jump = 3, plot = TRUE, frost_thr = 1, plot_period = "full", plot_export = TRUE, interpol = 3.5*60, frag_len = NULL, plot_name = "VAN_abbr621", tz="GMT") 
```


first plot full dataset for dendrometer. Plot will be exported to working directory as pdf

##(OPTIONAL) Looking at this we can see that the tolerance for outliers and tolerance for jumps were set lower (more stringent) than default value. We can plot monthly instead and look at exported pdf for greater detail.


```{r}
#dend_L2_monthly <- proc_dendro_L2(dendro_L1 = dend_L1, temp_L1 = temp_data_L1, tol_out = 2, tol_jump = 3, frost_thr = 1, plot = TRUE, interpol = 3.5*60, plot_period = "monthly", plot_export = TRUE, plot_name = "dend310summer_monthly", tz="GMT") 
#graphics.off()
```

##(OPTIONAL) We can manually correct some areas where automated data cleaning was not up to snuff.

```{r}
#info on function here: ?corr_dendro_L2

#check errors in pdf and with this subset 
#dend_L2[which((dend_L2$flags)!="NA"),]

#highlight corrections made on the dendrometer data:
#(dend_L2[which(is.na(dend_L2$flags)==F),])
```


##(OPTIONAL) Calculating growing season start and end
For more infromation ?treenetproc::grow_seas

```{r}
#grow_seas_L2 <- grow_seas(dendro_L2 = dendro_data_L2,agg_yearly=TRUE)
#knitr::kable(grow_seas_L2,caption = "Sample output data of the function `grow_seas`.")
```


## Step 6: plot L2 processed data!

```{r}
ggplot((subset(CEN5180_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="CEN5180 dendrometer values (gray), annual growth (green), twd (red)")

ggplot((subset(CEN8642_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="CEN8642")


ggplot((subset(DT311_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT311 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(DT646_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT646 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(DT655_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="DT655 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQRIP112_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQRIP112 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQRIP113_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQRIP113 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP118_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP118 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP119_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP119 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP122_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP122 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(HQSWP2577_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="HQSWP2577 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC07_5231_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC07_5231 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC07_5445_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC07_5445 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC09_3936_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC09_3936 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(PC09_4502_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="PC09_4502 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(RS20LWS_base__L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="RS20LWS_base dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(RS20TSHE_5523_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="RS20TSHE_5523 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(RS20TSHE_624_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="RS20TSHE_624 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_660_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_660 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_662_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_662 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_664_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_664 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_665_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_665 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_7297_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_7297 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(UPLO_abbr7297_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="UPLO_abbr7297 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(VAN_621_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_point(aes(y=twd), color = "red")+labs(title="VAN_621 dendrometer values (gray), annual growth (green), twd (red)")


ggplot((subset(VAN_abbr621_L2, frost == "FALSE")), aes(x=ts))+ geom_point(aes(y=value), color = "grey70")+ geom_point(aes(y=gro_yr), color = "seagreen")+ geom_line(aes(y=twd), color = "red")+labs(title="VAN_abbr621 dendrometer values (gray), annual growth (green), twd (red)")
```



What if we want to visualize cumulative growth instead of growth for each year?



```{r}
#The function phase_stats() will compute rates of expansion(growth) and shrinkage (twd) and aggregate these on a daily basis. 
#More info: ?phase_stats

DT311_phase <- phase_stats(DT311_L2, plot_phase = TRUE, plot_export = TRUE, agg_daily = TRUE, tz = 'GMT' )

#These growth and shrink rates can be compared with temperature, VPD and soil moisture.
#We will likely restrict this analysis to the growing season.
#some preliminary analysis/exploration using this

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=doy))+ geom_point(aes(y = shrink_amp, colour = "Shrinkage" ))+ geom_point(aes(y = exp_amp, colour ="Expansion"))+ ylab("Amplitude")

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=doy))+ geom_point(aes(y = shrink_slope, colour = "Shrinkage" ))+ geom_point(aes(y = exp_slope, colour ="Expansion"))+ ylab("Slope")

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=shrink_amp, y = exp_amp))+ geom_point()+ ylab(" Expansion amplitude")+ xlab(" Shrinkage amplitude")

ggplot(subset(DT311_phase, doy > 100 & doy < 250), aes(x=shrink_slope, y = exp_slope))+ geom_point()+ ylab(" Expansion slope")+ xlab(" Shrinkage slope")
```

## Step 6: Export

Now that data is cleaned, we can export for analysis with weather data.

```{r}
#for plotting 
write.csv(file = "TOMST311_cleaned.csv", DT311_L2)
write.csv(file = "TOMST646_cleaned.csv", DT646_L2)
write.csv(file = "TOMST655_cleaned.csv", DT655_L2)

#daily growth stats 
#write.csv(file = "dendro_310BAIfull_phase_stats.csv", DT311_phase)
```

## Step 7: Seeing the difference

Now that data is cleaned, we can see how a trace diagram looks again.
Again remember that 6 plots are missing here for now.

```{r}
CEN5180_L2$yr<-CEN5180ts$yr
ggplot(CEN5180_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN5180 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


CEN8642_L2$yr<-CEN8642ts$yr
ggplot(CEN8642_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="CEN8642 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


DT311_L2$yr<-DT311ts$yr
ggplot(DT311_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT311 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


DT646_L2$yr<-DT646ts$yr
ggplot(DT646_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT646 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


DT655_L2$yr<-DT655ts$yr
ggplot(DT655_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="DT655 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQRIP112_L2$yr<-HQRIP112ts$yr
ggplot(HQRIP112_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP112 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQRIP113_L2$yr<-HQRIP113ts$yr
ggplot(HQRIP113_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQRIP113 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(HQRIP116ts_L2,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="HQRIP116 Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


HQSWP118_L2$yr<-HQSWP118ts$yr
ggplot(HQSWP118_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP118 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQSWP119_L2$yr<-HQSWP119ts$yr
ggplot(HQSWP119_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP119 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(HQSWP121ts_L2,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="HQSWP121 Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


HQSWP122_L2$yr<-HQSWP122ts$yr
ggplot(HQSWP122_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP122 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


HQSWP2577_L2$yr<-HQSWP2577ts$yr
ggplot(HQSWP2577_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="HQSWP2577 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC07_5231_L2$yr<-PC07_5231ts$yr
ggplot(PC07_5231_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5231 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC07_5445_L2$yr<-PC07_5445ts$yr
ggplot(PC07_5445_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC07_5445 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC09_3936_L2$yr<-PC09_3936ts$yr
ggplot(PC09_3936_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_3936 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


PC09_4502_L2$yr<-PC09_4502ts$yr
ggplot(PC09_4502_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="PC09_4502 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


RS20LWS_base__L2$yr<-RS20LWS_base_ts$yr
ggplot(RS20LWS_base__L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20LWS_base Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(RS20LWS_branch_ts,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="RS20LWS_branch Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


#ggplot(RS20LWS_midcanopy_ts,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="RS20LWS_midcanopy Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


RS20TSHE_5523_L2$yr<-RS20TSHE_5523ts$yr
ggplot(RS20TSHE_5523_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_5523 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


RS20TSHE_624_L2$yr<-RS20TSHE_624ts$yr
ggplot(RS20TSHE_624_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="RS20TSHE_624 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()

#ggplot(RS20TSHE_625ts,aes(x=ts,y=value,color=yr))+
#  geom_point()+
#  geom_point(na.rm=TRUE)+
#  labs(title="RS20TSHE_625 Stem Diameter Changes",x="Date",y="Stem Diameter Change
#  (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()


UPLO_660_L2$yr<-UPLO_660ts$yr
ggplot(UPLO_660_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_660 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_662_L2$yr<-UPLO_662ts$yr
ggplot(UPLO_662_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_662 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_664_L2$yr<-UPLO_664ts$yr
ggplot(UPLO_664_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_664 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_665_L2$yr<-UPLO_665ts$yr
ggplot(UPLO_665_L2,aes(x=ts,y=value,color=yr))+
  geom_point()+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_665 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_7297_L2$yr<-UPLO_7297ts$yr
ggplot(UPLO_7297_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_7297 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


UPLO_abbr7297_L2$yr<-UPLO_abbr7297ts$yr
ggplot(UPLO_abbr7297_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="UPLO_abbr7297 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


VAN_621_L2$yr<-VAN_621ts$yr
ggplot(VAN_621_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_621 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


VAN_abbr621_L2$yr<-VAN_abbr621ts$yr
ggplot(VAN_abbr621_L2,aes(x=ts,y=value,color=yr))+
  geom_point(na.rm=TRUE)+
  labs(title="VAN_abbr621 Stem Diameter Changes (Cleaned)",x="Date",y="Stem Diameter Change
  (µm)",color="Legend") +
  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
  theme_minimal()


#ggplot(VAN_622ts,aes(x=ts,y=value,color=yr))+
# geom_point(na.rm=TRUE)+
#  labs(title="RS20TSHE_622 Stem Diameter Changes",x="Date",y="Stem Diameter Change
# (µm)",color="Legend") +
#  guides(color=guide_legend(override.aes = list(alpha = 1, size = 5)))+
#  theme_minimal()

```

```{r}
#First grab years string
years <-left(DT311full_cleaned_L0[,"ts"],4)
#To plot, set number of plots with par()
par(mfrow=c(1,1))
#Then set margins 
par(mar = c(5, 5, 5, 5))

for(y in 1:length(unique(years))){
#Now we can select years
sel<-DT311full_cleaned_L0[which(years==unique(years)[y]),]
#But we need to handle first year first
if(y==1){
   plot(difftime(as.POSIXct(sel$ts,format="%Y-%m-%d %H:%M:%S",tz="GMT"),
  as.POSIXct(paste0(unique(years)[y],"-01-01 00:00:00"),
                  format="%Y-%m-%d %H:%M:%S",tz="GMT"),
                  units = "days"),
         sel$gro_yr,
         ylab="Dendrometer reading (microns)",
         xlab="Day of year",type="l",
         col=rainbow(length(unique(years)))[y],pch=16,
         xlim=c(90,365),
         ylim=c(min(DT311full_cleaned_L0$gro_yr,na.rm=T),
                max(DT311full_cleaned_L0$gro_yr,na.rm=T)),
         main="310 BAI Cleaned")
    
    legend("topleft",
           as.character(unique(DT311full_cleaned_L0$yr)),
           col=rainbow(length(unique(DT311full_cleaned_L0$yr))),
           bty="n",pch=16)
# Now we can add other years
  }else{
    lines(difftime(as.POSIXct(sel$ts,format="%Y-%m-%d %H:%M:%S",tz="GMT"),
                   as.POSIXct(paste0(unique(years)[y],"-01-01 00:00:00"),
                              format="%Y-%m-%d %H:%M:%S",tz="GMT"),
                   units = "days"),
          sel$gro_yr,
          col=rainbow(length(unique(years)))[y],pch=16)}
}
```
